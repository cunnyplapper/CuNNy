// CuNNy 1x8C BILINEAR NVL SH
// Copyright (c) 2024 cunnyplapper

// This program is free software; you can redistribute it and/or
// modify it under the terms of the GNU Lesser General Public
// License as published by the Free Software Foundation; either
// version 3.0 of the License, or (at your option) any later version.
// 
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
// Lesser General Public License for more details.
// 
// You should have received a copy of the GNU Lesser General Public
// License along with this program.  If not, see <https://www.gnu.org/licenses/>.
/* ------------------------------------------------------------------- */

//!MAGPIE EFFECT
//!VERSION 3
//!OUTPUT_WIDTH INPUT_WIDTH * 2
//!OUTPUT_HEIGHT INPUT_HEIGHT * 2

//!TEXTURE
Texture2D INPUT;


//!SAMPLER
//!FILTER POINT
SamplerState SP;

//!SAMPLER
//!FILTER LINEAR
SamplerState SL;

//!TEXTURE
//!WIDTH INPUT_WIDTH
//!HEIGHT INPUT_HEIGHT
//!FORMAT R8G8B8A8_SNORM
Texture2D up_0;

//!TEXTURE
//!WIDTH INPUT_WIDTH
//!HEIGHT INPUT_HEIGHT
//!FORMAT R8G8B8A8_SNORM
Texture2D up_1;

//!TEXTURE
//!WIDTH INPUT_WIDTH
//!HEIGHT INPUT_HEIGHT
//!FORMAT R8G8B8A8_SNORM
Texture2D conv1_0;

//!TEXTURE
//!WIDTH INPUT_WIDTH
//!HEIGHT INPUT_HEIGHT
//!FORMAT R8G8B8A8_SNORM
Texture2D conv1_1;

//!TEXTURE
//!WIDTH INPUT_WIDTH
//!HEIGHT INPUT_HEIGHT
//!FORMAT R8G8B8A8_SNORM
Texture2D down;

//!PASS 1
//!DESC CuNNy-1x8C-BILINEAR-NVL-SH-up
//!BLOCK_SIZE 8
//!NUM_THREADS 64
//!IN INPUT
//!OUT up_0, up_1
#define O(t, p) t.SampleLevel(SP, pos + p * pt, 0)
#define l0(x, y) dot(float3(0.299, 0.587, 0.114), O(INPUT, float2(x, y)).rgb)
float4 f0(float2 pt, float2 pos, min16float s0_0, min16float s0_1, min16float s0_2, min16float s0_3, min16float s0_4, min16float s0_5, min16float s0_6, min16float s0_7, min16float s0_8) {
	min16float4 r = 0.0;
	r += min16float4(0.025287194177508354, 0.0416233129799366, -0.061891064047813416, -0.008821357041597366) * s0_0;
	r += min16float4(-0.10034177452325821, -0.32763874530792236, 0.057072825729846954, 0.01703774556517601) * s0_1;
	r += min16float4(0.059612937271595, 0.05463387444615364, 0.0049087004736065865, 0.0426131896674633) * s0_2;
	r += min16float4(-0.032683245837688446, -0.04025603458285332, 0.20912496745586395, 0.00794888660311699) * s0_3;
	r += min16float4(0.23558610677719116, 0.3291015326976776, -0.3232421576976776, -0.01588675193488598) * s0_4;
	r += min16float4(-0.19660690426826477, -0.054807525128126144, -0.02367188036441803, -0.15283210575580597) * s0_5;
	r += min16float4(0.0017801435897126794, -0.001333117252215743, -0.06378192454576492, 0.05047105625271797) * s0_6;
	r += min16float4(0.1860847771167755, -0.0009717681678012013, 0.1839916706085205, -0.12841804325580597) * s0_7;
	r += min16float4(-0.1791991889476776, 0.0013297117548063397, 0.017210381105542183, 0.31321609020233154) * s0_8;
	r += float4(0.00034236066858284175, 0.0006648469716310501, -0.0016825200291350484, 0.0002649348753038794);
	return r;
}
float4 f1(float2 pt, float2 pos, min16float s0_0, min16float s0_1, min16float s0_2, min16float s0_3, min16float s0_4, min16float s0_5, min16float s0_6, min16float s0_7, min16float s0_8) {
	min16float4 r = 0.0;
	r += min16float4(-0.06544055789709091, 0.023696022108197212, 0.28333500027656555, 0.0020058085210621357) * s0_0;
	r += min16float4(-0.1338365375995636, 0.06567393988370895, -0.19287104904651642, 0.028341975063085556) * s0_1;
	r += min16float4(-0.02459695003926754, -0.09057103097438812, -0.043613363057374954, -0.022631550207734108) * s0_2;
	r += min16float4(0.015756772831082344, -0.024034151807427406, 0.16422176361083984, -0.19489818811416626) * s0_3;
	r += min16float4(0.43853384256362915, -0.337040513753891, -0.23108281195163727, -0.2548828125) * s0_4;
	r += min16float4(-0.03578539192676544, 0.3623046278953552, 0.06385458260774612, 0.08762635290622711) * s0_5;
	r += min16float4(-0.05304481089115143, 0.0006740061799064279, -0.09910831600427628, 0.18896484375) * s0_6;
	r += min16float4(-0.08796773105859756, 0.05115421488881111, 0.07739247381687164, 0.2307223528623581) * s0_7;
	r += min16float4(-0.030878029763698578, -0.051181577146053314, -0.021404588595032692, -0.06596507877111435) * s0_8;
	r += float4(-0.004544440191239119, -0.0009950174717232585, -0.0018999098101630807, -0.00043434282997623086);
	return r;
}
void Pass1(uint2 blockStart, uint3 tid) {
	float2 pt = float2(GetInputPt());
	uint2 gxy = Rmp8x8(tid.x) + blockStart;
	uint2 size = GetInputSize();
	if (gxy.x >= size.x || gxy.y >= size.y) {
		return;
	}
	float2 pos = (gxy + 0.5) * pt;
	min16float s0_0 = l0(-1.0, -1.0);
	min16float s0_1 = l0(0.0, -1.0);
	min16float s0_2 = l0(1.0, -1.0);
	min16float s0_3 = l0(-1.0, 0.0);
	min16float s0_4 = l0(0.0, 0.0);
	min16float s0_5 = l0(1.0, 0.0);
	min16float s0_6 = l0(-1.0, 1.0);
	min16float s0_7 = l0(0.0, 1.0);
	min16float s0_8 = l0(1.0, 1.0);
	up_0[gxy] = f0(pt, pos, s0_0, s0_1, s0_2, s0_3, s0_4, s0_5, s0_6, s0_7, s0_8);
	up_1[gxy] = f1(pt, pos, s0_0, s0_1, s0_2, s0_3, s0_4, s0_5, s0_6, s0_7, s0_8);
}
//!PASS 2
//!DESC CuNNy-1x8C-BILINEAR-NVL-SH-conv1
//!BLOCK_SIZE 8
//!NUM_THREADS 64
//!IN up_0, up_1
//!OUT conv1_0, conv1_1
#define O(t, p) t.SampleLevel(SP, pos + p * pt, 0)
#define l0(x, y) O(up_0, float2(x, y))
#define l1(x, y) O(up_1, float2(x, y))
float4 f0(float2 pt, float2 pos, min16float4 s0_0, min16float4 s0_1, min16float4 s0_2, min16float4 s0_3, min16float4 s0_4, min16float4 s0_5, min16float4 s0_6, min16float4 s0_7, min16float4 s0_8, min16float4 s1_0, min16float4 s1_1, min16float4 s1_2, min16float4 s1_3, min16float4 s1_4, min16float4 s1_5, min16float4 s1_6, min16float4 s1_7, min16float4 s1_8, min16float4 s2_0, min16float4 s2_1, min16float4 s2_2, min16float4 s2_3, min16float4 s2_4, min16float4 s2_5, min16float4 s2_6, min16float4 s2_7, min16float4 s2_8, min16float4 s3_0, min16float4 s3_1, min16float4 s3_2, min16float4 s3_3, min16float4 s3_4, min16float4 s3_5, min16float4 s3_6, min16float4 s3_7, min16float4 s3_8) {
	min16float4 r = 0.0;
	r += mul(s0_0, min16float4x4(0.3365976810455322, -0.2719416916370392, 0.23689576983451843, 0.24931730329990387, -0.030150167644023895, -0.0241111908107996, -0.10397566109895706, -0.0015043856110423803, -0.11733590066432953, 0.10140695422887802, -0.23865792155265808, 0.1844365894794464, -0.09755098074674606, -0.018912548199295998, -0.06313680857419968, -0.02668132446706295));
	r += mul(s0_1, min16float4x4(0.10669016093015671, -0.15856535732746124, 0.0974121019244194, 0.010662688873708248, -0.14893636107444763, 0.02372458390891552, -0.1788535714149475, -0.0819224938750267, 0.14293871819972992, -0.4090079367160797, -0.6720206141471863, 0.04180591180920601, -0.055381838232278824, -0.029248692095279694, -0.08611104637384415, 0.05944627895951271));
	r += mul(s0_2, min16float4x4(0.10646559298038483, 0.12943080067634583, 0.025639068335294724, 0.0935269445180893, -0.03020111285150051, -0.11825137585401535, -0.12845928966999054, -0.1202537789940834, -0.2663298547267914, 0.040034499019384384, -0.214248925447464, -0.08088897913694382, 0.18660122156143188, 0.055369336158037186, -0.08330542594194412, 0.1291130930185318));
	r += mul(s0_3, min16float4x4(-0.42429280281066895, -0.356690376996994, -0.001473092008382082, 0.17913445830345154, -0.01895141787827015, -0.1977883130311966, -0.02463524229824543, -0.07095161080360413, 0.10940314084291458, -0.012727690860629082, 0.04692835360765457, -0.11505334079265594, -0.14963269233703613, -0.0052473279647529125, 0.12038801610469818, -0.22397857904434204));
	r += mul(s0_4, min16float4x4(-0.1476564109325409, 0.008747910149395466, -0.008086321875452995, -0.03608714044094086, -0.006491216830909252, -0.4033507704734802, -0.16698840260505676, -0.04366730898618698, 0.5176240801811218, 0.18571221828460693, 1.7165645360946655, -0.4390718638896942, 0.06510622054338455, -0.08313824981451035, 0.11339379847049713, -0.11188764125108719));
	r += mul(s0_5, min16float4x4(-0.10760410875082016, 0.00232740119099617, 0.08734244108200073, -0.054530367255210876, -0.049730122089385986, 0.8176920413970947, 0.018825246021151543, -0.05748400837182999, -0.011286595836281776, 0.3043414056301117, -0.2115991860628128, 0.2770019471645355, -0.04427275434136391, 0.1377457082271576, 0.02212388627231121, 0.04092036932706833));
	r += mul(s0_6, min16float4x4(0.08702979981899261, 0.04600559175014496, -0.2231161743402481, -0.0768953487277031, -0.1729925125837326, -0.08715730905532837, -0.020894326269626617, 0.02557874098420143, -0.1398918330669403, -0.04075288400053978, 0.2082861363887787, -0.26270249485969543, 0.14157487452030182, 0.06664323061704636, -0.11916852742433548, 0.12464769184589386));
	r += mul(s0_7, min16float4x4(-0.035266224294900894, 0.02089044824242592, -0.101417176425457, -0.04376745596528053, -0.07572468370199203, -0.02976047992706299, 0.8007150292396545, 0.017842302098870277, 0.42075031995773315, 0.04603685811161995, 0.16741885244846344, 0.22499796748161316, 0.014384779147803783, -0.013533034361898899, 0.011529713869094849, 0.16650380194187164));
	r += mul(s0_8, min16float4x4(-0.0005351428408175707, -0.00011829510185634717, 0.005404367111623287, -0.17826320230960846, -0.0029682288877665997, 0.1513833850622177, 0.22694122791290283, -0.13056913018226624, 0.1363319754600525, 0.08593428879976273, 0.5959270000457764, 0.7287877798080444, -0.0027158118318766356, -0.08303628116846085, 0.017613474279642105, -0.13156534731388092));
	r += mul(s1_0, min16float4x4(0.4385100305080414, -0.13369689881801605, 0.5566953420639038, 0.03200176730751991, -0.49428510665893555, -0.02389347366988659, -0.26269689202308655, -0.09412717819213867, 0.005920313764363527, 0.07268411666154861, 0.015657514333724976, -0.03525400906801224, -2.872154474258423, 0.2752353847026825, -0.6157863140106201, -0.6317610144615173));
	r += mul(s1_1, min16float4x4(0.9328773617744446, -1.1361578702926636, 0.8341915011405945, 0.15870429575443268, -0.46405577659606934, -0.6076496243476868, -0.4580099284648895, -0.14490994811058044, -0.2344406694173813, 0.08218001574277878, 0.24051715433597565, -0.05393940955400467, 0.22626210749149323, -0.0498463436961174, -0.05450456216931343, 0.6880034804344177));
	r += mul(s1_2, min16float4x4(0.10775797814130783, -0.006825269665569067, 0.17724809050559998, 0.17932793498039246, -0.38574251532554626, 0.26486727595329285, -0.26803603768348694, -0.14864972233772278, 0.06400126963853836, -1.4883067607879639, -0.2730100452899933, -0.2849026620388031, -0.09053172171115875, 0.11694034188985825, -0.003043216187506914, -0.010376018472015858));
	r += mul(s1_3, min16float4x4(-0.005661281291395426, 0.04978785663843155, -0.25868359208106995, 0.2124873697757721, -0.1794935017824173, -0.46743085980415344, 0.1871807873249054, 0.09806469827890396, 0.11331281810998917, 0.03921273350715637, 0.06861887127161026, 0.09036732465028763, 0.1560603678226471, 0.258258193731308, -0.2517525851726532, -0.5089014172554016));
	r += mul(s1_4, min16float4x4(-0.5450626015663147, 0.17501644790172577, -0.7939455509185791, -0.24090997874736786, -1.330223798751831, -0.058451272547245026, 0.07271748781204224, -0.7565293312072754, 0.05626438558101654, 0.05774618312716484, 0.023158852010965347, 0.10320132970809937, 0.06223480403423309, -0.03038320131599903, 0.13811440765857697, 0.07864677160978317));
	r += mul(s1_5, min16float4x4(-0.12365945428609848, 0.13135278224945068, -0.24178113043308258, 0.05213707312941551, -0.15898136794567108, 1.1110905408859253, 0.05690738931298256, -0.8900030255317688, -0.19255173206329346, -0.14563341438770294, -0.02065032534301281, 0.12609849870204926, 0.07122316211462021, -0.17274636030197144, 0.31833070516586304, 0.06458546221256256));
	r += mul(s1_6, min16float4x4(-0.27656587958335876, -0.10574949532747269, 0.05054108798503876, -0.08747042715549469, 0.5488322377204895, -0.07897993922233582, 0.11140815913677216, 0.021140625700354576, 0.12256729602813721, 0.004564925096929073, -0.07460716366767883, 0.17791157960891724, -0.19348286092281342, 0.07314570248126984, -0.27424344420433044, -0.17829182744026184));
	r += mul(s1_7, min16float4x4(-0.28363972902297974, -0.08517932891845703, -0.14428289234638214, -0.4363258183002472, 1.2460980415344238, 0.017387226223945618, 0.15959025919437408, 0.19230684638023376, 0.12713387608528137, 0.07948597520589828, 0.21884673833847046, 0.0895894318819046, 0.0679728090763092, -0.14463669061660767, -0.25751206278800964, -0.14966106414794922));
	r += mul(s1_8, min16float4x4(-0.05752275511622429, 0.08286344259977341, -0.10030313581228256, -0.09790147840976715, 0.4546734690666199, -0.14993783831596375, 0.26121753454208374, 0.19594165682792664, 0.030982807278633118, -0.08889156579971313, 0.014461309649050236, 0.26932647824287415, -0.056146491318941116, 0.0951850563287735, -0.2519638240337372, 0.012888187542557716));
	r += mul(s2_0, min16float4x4(0.031666383147239685, 0.09205811470746994, -0.004621902946382761, 0.039469439536333084, -0.3711742162704468, 0.09163754433393478, -0.23555077612400055, 0.06813900917768478, -0.022128203883767128, -0.06904496997594833, 0.017931481823325157, -0.0012031786609441042, -0.06863249838352203, 0.05090145021677017, -0.033053673803806305, 0.0024996662978082895));
	r += mul(s2_1, min16float4x4(-0.013993902131915092, -0.033115655183792114, 0.21123376488685608, 0.07299789041280746, -1.2849295139312744, 0.3647392690181732, -1.0677134990692139, -0.32489749789237976, 0.23810629546642303, -0.22803814709186554, 0.0821598693728447, 0.09613244980573654, 0.08596239984035492, 0.317400723695755, -0.6731393337249756, -0.05157763510942459));
	r += mul(s2_2, min16float4x4(0.10352335125207901, 0.07714564353227615, 0.061242248862981796, 0.08400280028581619, 0.01727687194943428, 0.12359791249036789, -0.008814508095383644, -0.055453259497880936, 0.11458839476108551, 0.10093560814857483, 0.05480421334505081, 0.10767865926027298, -0.07138773053884506, -0.26213937997817993, -0.45219627022743225, -0.08649472147226334));
	r += mul(s2_3, min16float4x4(-0.035682231187820435, 0.0370023250579834, 0.02318979986011982, 0.016019009053707123, -0.10430523008108139, 0.08990289270877838, -0.23021763563156128, -0.06608505547046661, 0.12424624711275101, 0.05100316181778908, 0.2055700123310089, -0.033558160066604614, 0.13552643358707428, 0.007911931723356247, -0.03548156097531319, -0.009362142533063889));
	r += mul(s2_4, min16float4x4(-0.12373941391706467, -0.052777908742427826, -0.01882242225110531, -0.005786496680229902, -0.3498418629169464, -0.07418636232614517, 0.2051411271095276, -0.5599221587181091, -0.1963125616312027, -0.15255790948867798, 0.1440444439649582, -0.0017272522673010826, 0.08706095069646835, 0.17371529340744019, 0.7644208669662476, -0.027171457186341286));
	r += mul(s2_5, min16float4x4(0.03989185020327568, -0.21360649168491364, 0.008637621067464352, 0.011695562861859798, -0.07343457639217377, 0.06632468104362488, 0.0628679171204567, -0.35644394159317017, 0.14767378568649292, 0.2596389651298523, 0.2872122824192047, 0.04965280741453171, -0.022699065506458282, -0.3798476755619049, 0.4190431237220764, -0.4265075623989105));
	r += mul(s2_6, min16float4x4(0.00724366307258606, -0.04284363240003586, 0.07374683022499084, -0.1681242138147354, 0.23491419851779938, 0.08540535718202591, -0.018208594992756844, -0.22205670177936554, -0.12118961662054062, -0.07344412058591843, -0.10195546597242355, 0.058418452739715576, -0.026023903861641884, -0.07569820433855057, 0.10777178406715393, -0.04154760017991066));
	r += mul(s2_7, min16float4x4(-0.09264922887086868, -0.04751630872488022, -0.03500918671488762, -0.40698888897895813, 0.8629878759384155, -0.08787591755390167, 0.6972660422325134, 0.5527309775352478, -0.1722729206085205, 0.14331774413585663, -0.24356916546821594, -0.3627224862575531, 0.1377369910478592, 0.08409519493579865, 0.14092355966567993, 0.16432926058769226));
	r += mul(s2_8, min16float4x4(-0.00634701969102025, -0.04141094163060188, 0.09028187394142151, -0.3342670798301697, 0.1311473250389099, -0.32143282890319824, 0.2978500425815582, 0.12428577244281769, -0.2677188515663147, 0.07403411716222763, -0.2627609074115753, -0.15506292879581451, 0.04215564206242561, -0.11638745665550232, -0.06529602408409119, 0.07727497816085815));
	r += mul(s3_0, min16float4x4(0.017710406333208084, 0.14811863005161285, -0.0673174113035202, -0.06896824389696121, -0.39206957817077637, -0.33353203535079956, -0.4966835379600525, -0.14476923644542694, 0.0409807488322258, 0.005957706831395626, 0.04784446582198143, -0.010131661780178547, -0.11672049015760422, 0.03190138563513756, -0.10901764035224915, -0.14830951392650604));
	r += mul(s3_1, min16float4x4(1.0038399696350098, 0.414842814207077, 0.6948674917221069, 0.1789565235376358, -0.1931334286928177, 0.12152101844549179, -0.24979738891124725, -0.14637064933776855, 0.029999658465385437, -0.05861590430140495, 0.15208864212036133, -0.004548550583422184, -0.24261817336082458, 0.20539787411689758, -0.015190484002232552, -0.19484619796276093));
	r += mul(s3_2, min16float4x4(-0.0029780578333884478, -0.6107262372970581, -0.012924746610224247, 0.15663592517375946, -0.16650430858135223, -0.32246387004852295, -0.09741008281707764, -0.037263695150613785, 0.06444131582975388, 0.0162837952375412, 0.22474601864814758, -0.09331515431404114, -0.031509917229413986, -0.5198230743408203, -0.09017928689718246, -0.5729361176490784));
	r += mul(s3_3, min16float4x4(0.16061519086360931, 0.20795442163944244, -0.11600789427757263, 0.12282436341047287, -0.1923203468322754, -0.21823245286941528, -0.13136565685272217, -0.11826394498348236, -0.07378046959638596, -0.08762656897306442, -0.1130516529083252, -0.01051398366689682, -0.021186331287026405, -0.009730901569128036, 0.07373395562171936, -0.053275104612112045));
	r += mul(s3_4, min16float4x4(-0.3484784662723541, 0.06957230716943741, 0.1973811835050583, 0.091575987637043, 0.18295514583587646, 0.03988217934966087, -0.018471049144864082, -0.1087011843919754, 0.03199181705713272, 0.02255184017121792, -0.2629958391189575, 0.0028445704374462366, 0.026293715462088585, -0.0069188317283988, 0.10200271755456924, 0.019890911877155304));
	r += mul(s3_5, min16float4x4(-0.07438255846500397, -0.06857168674468994, -0.007687538396567106, -0.17618487775325775, 0.0896720364689827, 0.06565389782190323, -0.029131457209587097, 0.015299148857593536, 0.10375441610813141, -1.9342455863952637, 0.059451498091220856, 0.3858036398887634, 0.14077861607074738, 0.09443262219429016, -0.0005534631782211363, 0.07807005941867828));
	r += mul(s3_6, min16float4x4(0.043115466833114624, 0.07649362087249756, 0.03095843456685543, 0.12377935647964478, 0.1547812670469284, 0.04921333119273186, 0.6473475098609924, 0.04777342826128006, -0.038697242736816406, 0.013783922418951988, 0.027845125645399094, -0.022452134639024734, 0.12310580909252167, 0.050346702337265015, -0.024974294006824493, 0.09880289435386658));
	r += mul(s3_7, min16float4x4(-0.22831104695796967, 0.08472681045532227, -0.6818488836288452, -0.13600318133831024, 0.170409694314003, 0.10034583508968353, 0.2989034056663513, 0.20596933364868164, -0.024245567619800568, -0.02587646059691906, -0.057959407567977905, 0.03449741750955582, 0.05052453279495239, -0.033419862389564514, 0.08574559539556503, 0.1977585256099701));
	r += mul(s3_8, min16float4x4(0.043117571622133255, 0.027920199558138847, -0.18871329724788666, -0.502075731754303, 0.12645506858825684, 0.20057785511016846, -0.1567770093679428, 0.2183016538619995, -0.033274032175540924, -0.24286526441574097, -0.030867381021380424, 0.1084863618016243, -0.04653066024184227, 0.014479934237897396, 0.11164651811122894, 0.14041760563850403));
	r += float4(-0.00615348806604743, -0.0021239970810711384, 0.0018285067053511739, -0.006917993538081646);
	return r;
}
float4 f1(float2 pt, float2 pos, min16float4 s0_0, min16float4 s0_1, min16float4 s0_2, min16float4 s0_3, min16float4 s0_4, min16float4 s0_5, min16float4 s0_6, min16float4 s0_7, min16float4 s0_8, min16float4 s1_0, min16float4 s1_1, min16float4 s1_2, min16float4 s1_3, min16float4 s1_4, min16float4 s1_5, min16float4 s1_6, min16float4 s1_7, min16float4 s1_8, min16float4 s2_0, min16float4 s2_1, min16float4 s2_2, min16float4 s2_3, min16float4 s2_4, min16float4 s2_5, min16float4 s2_6, min16float4 s2_7, min16float4 s2_8, min16float4 s3_0, min16float4 s3_1, min16float4 s3_2, min16float4 s3_3, min16float4 s3_4, min16float4 s3_5, min16float4 s3_6, min16float4 s3_7, min16float4 s3_8) {
	min16float4 r = 0.0;
	r += mul(s0_0, min16float4x4(0.1528954654932022, 0.04531075432896614, 0.5146820545196533, -0.0719773918390274, -0.06913169473409653, 0.11606046557426453, -0.046748578548431396, 0.2638172209262848, 0.023946531116962433, 0.09226217865943909, -0.7642213702201843, 0.2539106011390686, 0.0783168375492096, -0.13533663749694824, -0.10587786883115768, 0.029743047431111336));
	r += mul(s0_1, min16float4x4(0.11677567660808563, 0.0778806060552597, -0.09646206349134445, 0.22695374488830566, 0.03499086946249008, -0.1684608906507492, 0.052431799471378326, -0.2172641009092331, 0.19871440529823303, -0.29841145873069763, 0.2692258358001709, -0.9356631636619568, -0.08288561552762985, 0.024948785081505775, -0.040608860552310944, -0.047132041305303574));
	r += mul(s0_2, min16float4x4(0.10082316398620605, -0.05666745454072952, 0.0037545280065387487, -0.1352539211511612, 0.045160792768001556, -0.029966305941343307, 0.14812009036540985, 0.06208774447441101, -0.10375196486711502, -0.022335847839713097, 0.04308556765317917, 0.46841874718666077, -0.008393889293074608, 0.0038900214713066816, 0.1230267882347107, -0.04862651973962784));
	r += mul(s0_3, min16float4x4(-0.05712966248393059, 0.25910139083862305, -0.10127328336238861, 0.059328220784664154, 0.17449906468391418, 0.09830694645643234, -0.06566163897514343, 0.05714387074112892, 0.17232687771320343, 0.3953010141849518, -0.018281279131770134, -0.1867806762456894, 0.18081891536712646, 0.07382666319608688, 0.07456168532371521, 0.03571043536067009));
	r += mul(s0_4, min16float4x4(0.2928304970264435, -0.04344954714179039, -0.07063017040491104, 0.07442323118448257, -0.03959013894200325, -0.22314447164535522, 0.2888810634613037, -0.13915222883224487, -0.508876383304596, -0.27067095041275024, -0.6789776086807251, 0.43444639444351196, -0.1359976977109909, 0.058625075966119766, -0.00264825695194304, -0.057063162326812744));
	r += mul(s0_5, min16float4x4(0.0025767928455024958, 0.200566366314888, 0.02572890743613243, 0.016216859221458435, -0.09402155876159668, 0.11702420562505722, -0.1198786124587059, 0.05815492197871208, -0.9999642968177795, 0.011081086471676826, 0.3369646370410919, 0.49873942136764526, 0.17611435055732727, -0.08189862966537476, -0.14945490658283234, 0.030089661478996277));
	r += mul(s0_6, min16float4x4(-0.1037626564502716, -0.0017363574588671327, 0.10589125007390976, 0.07144289463758469, 0.05767111852765083, 0.5233470797538757, -0.25169649720191956, 0.24070866405963898, 0.08902250975370407, -0.7405832409858704, -0.12707142531871796, -0.03168290853500366, -0.038939494639635086, -0.08512730151414871, 0.04145744815468788, 0.008935727179050446));
	r += mul(s0_7, min16float4x4(0.07490607351064682, -0.11852516233921051, 0.022866321727633476, -0.001107102376408875, -1.3036319017410278, -0.09688657522201538, 0.11352818459272385, 0.1723320037126541, 0.315245121717453, 0.5652229189872742, -0.11432625353336334, -0.04546581953763962, -0.031134283170104027, 0.14892470836639404, 0.09252982586622238, 0.025966018438339233));
	r += mul(s0_8, min16float4x4(-0.04835551232099533, -0.027021927759051323, 0.017229976132512093, 0.023381445556879044, 0.34757980704307556, -0.7760071754455566, -0.12774711847305298, -0.22883102297782898, 0.1728353500366211, -0.4550318121910095, -0.17562638223171234, -0.17095613479614258, -0.06501454859972, -0.008339842781424522, -0.008409515023231506, -0.002875899663195014));
	r += mul(s1_0, min16float4x4(-0.10332732647657394, -0.008286281488835812, -0.6588935852050781, 0.20861515402793884, 0.11734724789857864, -0.14691831171512604, -0.6604613661766052, 0.32595357298851013, 0.027076486498117447, -0.16552647948265076, 0.2638535499572754, -0.20263686776161194, 0.020146481692790985, 0.3300103545188904, -0.21560312807559967, 1.077396035194397));
	r += mul(s1_1, min16float4x4(-0.06848118454217911, 0.08199485391378403, 0.2498801201581955, -0.22721189260482788, 0.09658744931221008, 0.12345283478498459, 0.47628435492515564, -0.005731684621423483, -0.06555614620447159, 0.3842276334762573, 0.04112846776843071, 0.10541985183954239, -0.7814666628837585, -0.13037844002246857, 0.05778077617287636, -0.5409243106842041));
	r += mul(s1_2, min16float4x4(0.17115585505962372, -0.04204820841550827, -0.15642516314983368, 0.26844656467437744, -0.08117464929819107, 0.13145090639591217, 0.3766951560974121, -0.058787450194358826, -0.12336421757936478, -0.007887457497417927, -0.1574915051460266, -0.18832343816757202, -0.2790789306163788, -0.05441882088780403, -0.7994552850723267, 0.4033219516277313));
	r += mul(s1_3, min16float4x4(-0.1938932240009308, 0.5992892980575562, -0.176616832613945, 0.21301431953907013, 0.07281150668859482, 0.31318017840385437, -0.19827447831630707, 0.9875649809837341, 0.07374119758605957, 0.06023237854242325, -0.19908754527568817, 0.19342808425426483, -0.15721383690834045, 0.33276039361953735, 0.49558743834495544, -0.6029764413833618));
	r += mul(s1_4, min16float4x4(-0.04330083355307579, 0.004938871134072542, 0.0587574765086174, -0.14395923912525177, -0.2653861343860626, -0.24856515228748322, -0.1748751550912857, 0.32876795530319214, -0.29167816042900085, -0.3820800185203552, -0.0033372656907886267, 0.0920310914516449, -1.3604611158370972, 0.3374813497066498, 0.025670187547802925, -0.1992325633764267));
	r += mul(s1_5, min16float4x4(0.6434597373008728, -0.15018044412136078, 0.18737851083278656, -0.07336311787366867, 0.3138987123966217, -0.28222161531448364, 0.6039872765541077, -0.9899609684944153, -0.15438254177570343, -0.32072505354881287, -0.4228503704071045, -0.21878495812416077, 0.28808555006980896, 0.012447238899767399, -0.038133203983306885, -0.056202758103609085));
	r += mul(s1_6, min16float4x4(-0.1508043110370636, 0.15210004150867462, -0.03247155249118805, 0.016621602699160576, -0.07234667241573334, 0.16752010583877563, 0.06244487687945366, 0.07233287394046783, 0.1572398841381073, -0.11045657843351364, 0.11548794060945511, 0.013279841281473637, -0.3929884135723114, -0.1435442864894867, -0.04946501553058624, -0.1827695369720459));
	r += mul(s1_7, min16float4x4(-0.06589994579553604, 0.031644098460674286, -0.017829276621341705, 0.07259080559015274, -0.6808433532714844, 0.671892523765564, -0.03489651903510094, 0.2396029531955719, 0.06616614013910294, 0.17807351052761078, 0.133783757686615, -0.0193722452968359, -0.34660518169403076, 0.07882341742515564, 0.038805700838565826, 0.09456627070903778));
	r += mul(s1_8, min16float4x4(0.37247607111930847, -0.07147099077701569, 0.03365300968289375, -0.0862400010228157, -0.0599040649831295, -0.031324613839387894, 0.07589029520750046, -0.02384965680539608, 0.1369132548570633, 0.21790482103824615, -0.022139670327305794, 0.11361726373434067, 0.12968437373638153, -0.08109886944293976, -0.08824589848518372, -0.05059828236699104));
	r += mul(s2_0, min16float4x4(0.03692793846130371, 0.010349558666348457, 0.11834533512592316, -0.1516476422548294, -0.02042991667985916, -0.11019142717123032, -0.8461260795593262, 0.777934193611145, 0.009514376521110535, -0.00629402557387948, -0.06331487745046616, 0.08846146613359451, -0.0003116668085567653, -0.03583977371454239, -0.08027715235948563, 0.15445692837238312));
	r += mul(s2_1, min16float4x4(-0.003045544261112809, -0.021534742787480354, -0.1631314754486084, 0.03466510400176048, 0.02974441461265087, -0.02091112546622753, 1.3144383430480957, -0.2823118567466736, -0.004722718149423599, 0.02702164091169834, 0.34015175700187683, -0.10928294062614441, 0.11936227977275848, -0.2058510184288025, 0.14248624444007874, -0.34837812185287476));
	r += mul(s2_2, min16float4x4(-0.07189775258302689, 0.0734880343079567, -0.1430741846561432, 0.1173836961388588, 0.03240806236863136, -0.001192600466310978, 0.10298420488834381, 0.8477252721786499, 0.024997645989060402, -0.013704887591302395, 0.058369167149066925, -0.22688160836696625, -0.05774802342057228, 0.10172748565673828, 0.17024913430213928, 0.7344622611999512));
	r += mul(s2_3, min16float4x4(-0.12470617890357971, -0.07215957343578339, -0.027942104265093803, 0.06468738615512848, 0.044157784432172775, -0.006757218856364489, 0.46625813841819763, 0.1751907616853714, -0.04350052773952484, 0.02873263880610466, -0.07528598606586456, 0.011169238947331905, 0.016930079087615013, -0.08776167035102844, 0.08891463279724121, -0.011179251596331596));
	r += mul(s2_4, min16float4x4(0.11225572973489761, -0.018594888970255852, 0.05903368443250656, 0.1198243796825409, -0.10372132807970047, -0.33191755414009094, -0.21282386779785156, -0.03601730987429619, -0.19675056636333466, 0.2953161299228668, 0.3799445629119873, -0.03666647896170616, 0.43247511982917786, -0.726224958896637, 0.25183916091918945, -0.33981046080589294));
	r += mul(s2_5, min16float4x4(0.016554029658436775, 0.00928546953946352, 0.060349155217409134, -0.03169475868344307, 0.7422730326652527, 0.07951845228672028, 0.05050751939415932, 0.11917592585086823, -0.21694934368133545, 0.04695051163434982, -0.07756715267896652, 1.7416852712631226, 0.7820586562156677, 0.3607310354709625, -0.043822888284921646, 0.27618005871772766));
	r += mul(s2_6, min16float4x4(0.023157740011811256, 0.10584654659032822, -0.029829179868102074, 0.07609223574399948, 0.418256938457489, -2.0890278816223145, 0.10196805745363235, -0.31391504406929016, -0.018301639705896378, -0.28350314497947693, 0.018049683421850204, 0.1233242005109787, -0.08960187435150146, -0.03454442694783211, -0.08770971745252609, 0.05581032857298851));
	r += mul(s2_7, min16float4x4(-0.07661928236484528, -0.000930013891775161, -0.057651590555906296, 0.0353737436234951, 0.025387071073055267, 0.12487126886844635, -0.06690094619989395, 0.12774480879306793, -0.08933179080486298, 0.04899846389889717, 0.14891333878040314, -0.1534285545349121, -0.05737314745783806, -0.10905463993549347, 0.12064096331596375, -0.030214669182896614));
	r += mul(s2_8, min16float4x4(-0.2405158430337906, -0.16590487957000732, 0.062283072620630264, -0.21226415038108826, -0.0915440022945404, 0.19982844591140747, -0.07410378009080887, 0.033258236944675446, 0.48254239559173584, -0.5579508543014526, -0.09291417896747589, 0.12713663280010223, 0.06275640428066254, -0.048698317259550095, 0.018142225220799446, -0.017333965748548508));
	r += mul(s3_0, min16float4x4(-0.08464191108942032, 0.014688030816614628, 0.503188967704773, -0.26721814274787903, 0.030458087101578712, -0.3251958191394806, 0.05451006814837456, 0.26586976647377014, -0.011055841110646725, 0.011505159549415112, 0.06124000996351242, 0.0028684274293482304, -0.002239067805930972, -0.032274406403303146, 0.07879417389631271, -0.23578979074954987));
	r += mul(s3_1, min16float4x4(-0.06593011319637299, 0.05034054070711136, -0.47324350476264954, -0.009968113154172897, 0.18296663463115692, 0.03274475783109665, 0.061011020094156265, -0.0050460416823625565, -0.010028512217104435, -0.07147597521543503, -0.1273072212934494, 0.09782061725854874, 0.06716737896203995, -0.24616354703903198, 0.063852459192276, -0.15664586424827576));
	r += mul(s3_2, min16float4x4(-0.021572016179561615, -0.15421828627586365, -0.3075753152370453, 0.5937058329582214, -0.037276700139045715, 0.019537005573511124, 0.19992658495903015, 0.0442940853536129, -0.006513860076665878, 0.038481444120407104, 0.06225729361176491, 0.11107936501502991, 0.015098094940185547, 0.1668468713760376, -0.3340597152709961, 0.8426625728607178));
	r += mul(s3_3, min16float4x4(-0.07680179923772812, 0.03769678622484207, -0.10142533481121063, -0.08992838114500046, 0.23953329026699066, 0.3609892725944519, -0.2448025345802307, 0.019379811361432076, 0.01244629267603159, 0.00500825559720397, -0.11724909394979477, 0.02041863091289997, -0.03359018266201019, 0.0007511300500482321, -0.05701468139886856, 0.02707821875810623));
	r += mul(s3_4, min16float4x4(0.17681577801704407, -0.030124928802251816, 0.24193701148033142, 0.0872994214296341, -0.006313233636319637, 0.0016724098240956664, 0.15966756641864777, -0.15252585709095, -0.011285562999546528, -0.015384540893137455, 0.09595710784196854, -0.14404377341270447, 0.11154849082231522, -0.45821794867515564, 0.007360095623880625, 0.03714073449373245));
	r += mul(s3_5, min16float4x4(0.7267653942108154, -0.001083848299458623, -0.022713657468557358, 0.09444600343704224, -0.07067981362342834, -0.09717775881290436, 0.13136973977088928, -0.04243228957056999, 0.05314188078045845, -0.1374162882566452, 0.08821157366037369, -0.26921671628952026, 0.5326201319694519, 0.1945599615573883, 0.10152410715818405, 0.08476993441581726));
	r += mul(s3_6, min16float4x4(-0.00014841801021248102, 0.07329215854406357, 0.0703800693154335, -0.11355718970298767, -0.19847676157951355, 0.11490017920732498, -0.07417096942663193, 0.10739842057228088, 0.0019646435976028442, -0.009883918799459934, -0.007093358784914017, 0.003362339688464999, 0.0509093776345253, -0.10027086734771729, 0.05447351932525635, -0.052656326442956924));
	r += mul(s3_7, min16float4x4(0.5189326405525208, -0.3923870325088501, -0.10565111041069031, -0.12614919245243073, 0.005166880786418915, 0.05063730850815773, 0.09151629358530045, -0.10240094363689423, 0.10966220498085022, 0.0436079278588295, 0.04606487229466438, 0.010543093085289001, 0.07246439903974533, -0.11851271241903305, -0.05804193764925003, 0.053731076419353485));
	r += mul(s3_8, min16float4x4(0.2628221809864044, 0.21975591778755188, 0.09252877533435822, 0.3322337865829468, 0.20173372328281403, -0.07885617762804031, -0.06997649371623993, 0.09680012613534927, -0.41025444865226746, 0.22172828018665314, 0.028719745576381683, -0.06356719881296158, -0.012230722233653069, 0.048596132546663284, 0.0011036850046366453, 0.051480550318956375));
	r += float4(0.001988801872357726, -0.0023140914272516966, 0.00022572251327801496, 0.004103058483451605);
	return r;
}
void Pass2(uint2 blockStart, uint3 tid) {
	float2 pt = float2(GetInputPt());
	uint2 gxy = Rmp8x8(tid.x) + blockStart;
	uint2 size = GetInputSize();
	if (gxy.x >= size.x || gxy.y >= size.y) {
		return;
	}
	float2 pos = (gxy + 0.5) * pt;
	min16float4 s0_0 = l0(-1.0, -1.0);
	min16float4 s0_1 = l0(0.0, -1.0);
	min16float4 s0_2 = l0(1.0, -1.0);
	min16float4 s0_3 = l0(-1.0, 0.0);
	min16float4 s0_4 = l0(0.0, 0.0);
	min16float4 s0_5 = l0(1.0, 0.0);
	min16float4 s0_6 = l0(-1.0, 1.0);
	min16float4 s0_7 = l0(0.0, 1.0);
	min16float4 s0_8 = l0(1.0, 1.0);
	min16float4 s1_0 = max(-s0_0, 0.0);
	min16float4 s1_1 = max(-s0_1, 0.0);
	min16float4 s1_2 = max(-s0_2, 0.0);
	min16float4 s1_3 = max(-s0_3, 0.0);
	min16float4 s1_4 = max(-s0_4, 0.0);
	min16float4 s1_5 = max(-s0_5, 0.0);
	min16float4 s1_6 = max(-s0_6, 0.0);
	min16float4 s1_7 = max(-s0_7, 0.0);
	min16float4 s1_8 = max(-s0_8, 0.0);
	s0_0 = max(s0_0, 0.0);
	s0_1 = max(s0_1, 0.0);
	s0_2 = max(s0_2, 0.0);
	s0_3 = max(s0_3, 0.0);
	s0_4 = max(s0_4, 0.0);
	s0_5 = max(s0_5, 0.0);
	s0_6 = max(s0_6, 0.0);
	s0_7 = max(s0_7, 0.0);
	s0_8 = max(s0_8, 0.0);
	min16float4 s2_0 = l1(-1.0, -1.0);
	min16float4 s2_1 = l1(0.0, -1.0);
	min16float4 s2_2 = l1(1.0, -1.0);
	min16float4 s2_3 = l1(-1.0, 0.0);
	min16float4 s2_4 = l1(0.0, 0.0);
	min16float4 s2_5 = l1(1.0, 0.0);
	min16float4 s2_6 = l1(-1.0, 1.0);
	min16float4 s2_7 = l1(0.0, 1.0);
	min16float4 s2_8 = l1(1.0, 1.0);
	min16float4 s3_0 = max(-s2_0, 0.0);
	min16float4 s3_1 = max(-s2_1, 0.0);
	min16float4 s3_2 = max(-s2_2, 0.0);
	min16float4 s3_3 = max(-s2_3, 0.0);
	min16float4 s3_4 = max(-s2_4, 0.0);
	min16float4 s3_5 = max(-s2_5, 0.0);
	min16float4 s3_6 = max(-s2_6, 0.0);
	min16float4 s3_7 = max(-s2_7, 0.0);
	min16float4 s3_8 = max(-s2_8, 0.0);
	s2_0 = max(s2_0, 0.0);
	s2_1 = max(s2_1, 0.0);
	s2_2 = max(s2_2, 0.0);
	s2_3 = max(s2_3, 0.0);
	s2_4 = max(s2_4, 0.0);
	s2_5 = max(s2_5, 0.0);
	s2_6 = max(s2_6, 0.0);
	s2_7 = max(s2_7, 0.0);
	s2_8 = max(s2_8, 0.0);
	conv1_0[gxy] = f0(pt, pos, s0_0, s0_1, s0_2, s0_3, s0_4, s0_5, s0_6, s0_7, s0_8, s1_0, s1_1, s1_2, s1_3, s1_4, s1_5, s1_6, s1_7, s1_8, s2_0, s2_1, s2_2, s2_3, s2_4, s2_5, s2_6, s2_7, s2_8, s3_0, s3_1, s3_2, s3_3, s3_4, s3_5, s3_6, s3_7, s3_8);
	conv1_1[gxy] = f1(pt, pos, s0_0, s0_1, s0_2, s0_3, s0_4, s0_5, s0_6, s0_7, s0_8, s1_0, s1_1, s1_2, s1_3, s1_4, s1_5, s1_6, s1_7, s1_8, s2_0, s2_1, s2_2, s2_3, s2_4, s2_5, s2_6, s2_7, s2_8, s3_0, s3_1, s3_2, s3_3, s3_4, s3_5, s3_6, s3_7, s3_8);
}
//!PASS 3
//!DESC CuNNy-1x8C-BILINEAR-NVL-SH-down
//!BLOCK_SIZE 8
//!NUM_THREADS 64
//!IN conv1_0, conv1_1
//!OUT down
#define O(t, p) t.SampleLevel(SP, pos + p * pt, 0)
#define l0(x, y) O(conv1_0, float2(x, y))
#define l1(x, y) O(conv1_1, float2(x, y))
float4 f0(float2 pt, float2 pos, min16float4 s0_0, min16float4 s0_1, min16float4 s0_2, min16float4 s0_3, min16float4 s0_4, min16float4 s0_5, min16float4 s0_6, min16float4 s0_7, min16float4 s0_8, min16float4 s1_0, min16float4 s1_1, min16float4 s1_2, min16float4 s1_3, min16float4 s1_4, min16float4 s1_5, min16float4 s1_6, min16float4 s1_7, min16float4 s1_8, min16float4 s2_0, min16float4 s2_1, min16float4 s2_2, min16float4 s2_3, min16float4 s2_4, min16float4 s2_5, min16float4 s2_6, min16float4 s2_7, min16float4 s2_8, min16float4 s3_0, min16float4 s3_1, min16float4 s3_2, min16float4 s3_3, min16float4 s3_4, min16float4 s3_5, min16float4 s3_6, min16float4 s3_7, min16float4 s3_8) {
	min16float4 r = 0.0;
	r += mul(s0_0, min16float4x4(-0.10226134210824966, 0.047749780118465424, 0.05970486253499985, 0.09053955227136612, -0.025036826729774475, -0.021329611539840698, 0.031987205147743225, -0.045889712870121, -0.09967862069606781, -0.039176687598228455, 0.059455711394548416, -0.011895258910953999, 1.415703296661377, 0.04420962184667587, -1.2866196632385254, -0.2783726155757904));
	r += mul(s0_1, min16float4x4(0.08265843987464905, -0.03384775668382645, -0.21619805693626404, -0.21911776065826416, 0.00425868621096015, -0.07812920212745667, -0.037851009517908096, -0.04040171578526497, 0.0801556184887886, -0.005224259570240974, 0.1270965188741684, 0.1753467172384262, 0.17744804918766022, 1.4070172309875488, -0.23697757720947266, -1.2758749723434448));
	r += mul(s0_2, min16float4x4(-0.04134354740381241, -0.05377490073442459, 0.06824270635843277, 0.02378413826227188, -1.8521915990277193e-05, 0.015322421677410603, 0.02333802729845047, 0.02044786512851715, -0.036967650055885315, -0.008494853042066097, 0.008974260650575161, 0.02034328505396843, 0.013019513338804245, -0.0035130579490214586, -0.06859620660543442, 0.09752530604600906));
	r += mul(s0_3, min16float4x4(0.020644184201955795, 0.026166407391428947, 0.13915711641311646, -0.07026761770248413, 0.8825562000274658, -0.9166869521141052, -0.12010323256254196, -0.05874965712428093, 0.001785825821571052, -0.014392408542335033, -0.1391601860523224, 0.0018419318366795778, 0.028408054262399673, 0.020078526809811592, -0.2803225815296173, -0.074423648416996));
	r += mul(s0_4, min16float4x4(-0.1721981316804886, -0.10799412429332733, 0.7452619671821594, 0.7205830216407776, -0.2329595983028412, 0.4364125728607178, -0.04196371138095856, 0.12330180406570435, -0.10468211024999619, -0.028827261179685593, -0.3076185882091522, -0.37878939509391785, 0.07239969819784164, 0.05094246193766594, -0.09616347402334213, -0.29856741428375244));
	r += mul(s0_5, min16float4x4(-0.03387993201613426, -0.08617368340492249, -0.11766280233860016, 0.11450426280498505, 0.048507269471883774, -0.05989382416009903, 0.02297626994550228, -0.06018094718456268, 0.08373969048261642, 0.005324617028236389, 0.0791148766875267, 0.0077529242262244225, 0.00046248731086961925, 0.014333074912428856, 0.0009157039457932115, -0.004846017342060804));
	r += mul(s0_6, min16float4x4(-0.015384526923298836, -0.0008336809696629643, -0.017758654430508614, -0.0015654158778488636, 0.7443177700042725, -1.0509891510009766, 1.6844462156295776, -2.0104868412017822, 0.02092202939093113, -0.008000855334103107, -0.013170795515179634, -0.01825093664228916, 0.014699747785925865, -0.01297325361520052, 0.04061010852456093, -0.010313441045582294));
	r += mul(s0_7, min16float4x4(0.011654090136289597, 0.013335790485143661, 0.031621888279914856, 0.042815446853637695, -0.43168890476226807, 0.30701208114624023, -0.6387538313865662, 0.5761720538139343, -0.037233948707580566, -0.005457786843180656, -0.039935529232025146, -0.02244371734559536, 0.001242747064679861, -0.0008376874029636383, 0.017480051144957542, 0.07253888994455338));
	r += mul(s0_8, min16float4x4(-0.006140864919871092, -0.013450643979012966, -0.042325709015131, -0.07266344875097275, 0.1071753203868866, -0.010528246872127056, 0.104647196829319, 0.020041754469275475, 0.023242784664034843, 0.007540619000792503, 0.019797569140791893, 0.010324963368475437, -0.016079964116215706, -0.012830082327127457, 0.00794144719839096, 0.002798373345285654));
	r += mul(s1_0, min16float4x4(-0.07341933995485306, -0.012188809923827648, 0.02847878821194172, -0.0349896103143692, 0.015746204182505608, 0.02613837458193302, 0.016311107203364372, -0.009200175292789936, 0.015589049085974693, 0.027237754315137863, 0.008028465323150158, 0.025082528591156006, 0.08528619259595871, 0.0306908767670393, -0.01156534906476736, 0.06615075469017029));
	r += mul(s1_1, min16float4x4(0.011140166781842709, -0.026579152792692184, -0.0019196837674826384, 0.05505639314651489, 0.007371440064162016, -0.0023686776403337717, 0.00036551032098941505, 0.041872184723615646, -0.015921851620078087, -0.036224089562892914, -0.029481904581189156, -0.05964197963476181, -0.02461002953350544, 0.05455433949828148, 0.025965476408600807, -0.03899085149168968));
	r += mul(s1_2, min16float4x4(-0.011556447483599186, -0.018589794635772705, 0.0005127610056661069, -0.002536102430894971, 0.004611149895936251, 0.0006396641256287694, -0.010342290624976158, -0.00894190464168787, 0.0041734823025763035, 0.008983363397419453, -0.0022470459807664156, 0.007053414825350046, 0.013846260495483875, -0.027940131723880768, 0.0032183274161070585, 0.0003695751656778157));
	r += mul(s1_3, min16float4x4(-0.0065642232075333595, 0.03034164197742939, -0.00947218481451273, 0.0010145575506612659, 0.10691863298416138, 0.03929337486624718, 0.036986853927373886, 0.08427056670188904, 0.10997530817985535, -0.05776168406009674, 0.05325775593519211, 0.05236392468214035, -0.03038618341088295, 0.02642247825860977, 0.04140351340174675, -0.032628610730171204));
	r += mul(s1_4, min16float4x4(-0.416993647813797, -0.4151838421821594, -0.05925130099058151, 0.011443492025136948, -0.18981508910655975, -0.05948458984494209, -0.06420841068029404, -0.12529301643371582, 0.5605466365814209, 0.5971964001655579, -0.1870122104883194, -0.1692095547914505, -0.08040754497051239, -0.11664215475320816, -0.07830266654491425, -0.03179528936743736));
	r += mul(s1_5, min16float4x4(0.06819237768650055, 0.027947774156928062, 0.06381671875715256, 0.012056113220751286, 0.03297748789191246, -0.04957588016986847, 0.03462085500359535, 0.0286161657422781, -0.1265832483768463, 0.005487783346325159, -0.028460519388318062, -0.04519225284457207, 0.007851795293390751, -0.002254539867863059, 0.004742742981761694, 0.018843108788132668));
	r += mul(s1_6, min16float4x4(0.08624714612960815, 0.02469596080482006, -0.10429578274488449, 0.006175342947244644, -0.03371813893318176, 0.019742293283343315, 0.027574941515922546, 0.02249915711581707, -0.0656731128692627, 0.0700693279504776, 0.06042846292257309, -0.036090392619371414, -0.008549143560230732, 0.005118485074490309, 0.027238277718424797, 0.010914640501141548));
	r += mul(s1_7, min16float4x4(0.16506034135818481, 0.1752929389476776, -0.07014025002717972, -0.19976022839546204, 0.05148138105869293, 0.016229702159762383, -0.0403556264936924, 0.0064667826518416405, -0.4550945460796356, -0.49891233444213867, 0.39970359206199646, 0.35252657532691956, 0.016698328778147697, -0.009218374267220497, -0.04534033313393593, 0.010002100840210915));
	r += mul(s1_8, min16float4x4(0.017020821571350098, 0.07841887325048447, 0.010265829972922802, -0.0016918095061555505, -0.0024755247868597507, -0.0026402920484542847, -0.0038438451010733843, -0.05737358331680298, 0.0472872331738472, -0.02671489305794239, -0.07775863260030746, 0.03702539578080177, 0.000703755475115031, 0.015223960392177105, 0.014249355532228947, -0.023448176681995392));
	r += mul(s2_0, min16float4x4(0.12939521670341492, -0.05598406121134758, -0.060119807720184326, -0.07822693139314651, 0.24960185587406158, -0.1903606504201889, 0.013092787936329842, -0.11197758466005325, -0.020839132368564606, -0.002676882781088352, -0.005939318332821131, 0.003670430276542902, -0.01047524530440569, -0.014531344175338745, -0.004762785974889994, 0.0031001728493720293));
	r += mul(s2_1, min16float4x4(-0.2436780035495758, -0.0002760388015303761, -0.05255214124917984, -0.005556228570640087, -1.7247189283370972, 1.0822319984436035, -0.5800853967666626, 0.5612874627113342, 0.0691039189696312, 0.047905657440423965, -0.00041327369399368763, -0.029513796791434288, -0.009302644059062004, 0.008919710293412209, -0.010720831342041492, -0.029770327731966972));
	r += mul(s2_2, min16float4x4(0.03429781645536423, -0.01089045125991106, 0.026833515614271164, 0.0241097304970026, 0.07924498617649078, 0.4477103352546692, -0.08346904814243317, 0.12913566827774048, -0.016925163567066193, 0.008754460141062737, 0.023370159789919853, 0.018318774178624153, 0.0019665632862597704, -0.004899690859019756, 0.0021637403406202793, 0.0015676440671086311));
	r += mul(s2_3, min16float4x4(-0.07592551410198212, 0.06261126697063446, 0.06714038550853729, 0.07606124132871628, -0.12165462970733643, -0.0006391301867552102, 0.03415323793888092, -0.047485508024692535, -0.07268709689378738, -0.04186214134097099, -0.05139344185590744, -0.05335882306098938, -0.11984121054410934, -0.11059842258691788, -0.07104132324457169, -0.08048681169748306));
	r += mul(s2_4, min16float4x4(0.06645394116640091, -0.0528125986456871, -0.09899439662694931, -0.09498921036720276, 0.2007925808429718, -0.036736227571964264, -0.8830346465110779, 0.5293006300926208, 0.045126356184482574, 0.11039308458566666, 0.17517271637916565, 0.19580036401748657, 0.2603757977485657, 0.12539727985858917, 0.07387382537126541, 0.06869236379861832));
	r += mul(s2_5, min16float4x4(-0.02747199870646, -0.016818026080727577, -0.015066655352711678, -0.03941212594509125, 0.129624605178833, -0.11837693303823471, 0.39517512917518616, 0.06750613451004028, 0.025340542197227478, -0.03473614528775215, -0.04951629787683487, -0.04340999573469162, -0.044399160891771317, 0.048449721187353134, -0.05041293427348137, -0.04689489305019379));
	r += mul(s2_6, min16float4x4(-0.011039512231945992, -0.012129143811762333, -0.012355746701359749, -0.01839267648756504, -0.029392918571829796, 0.0020224659238010645, -0.03450300171971321, 0.031191185116767883, -0.16259777545928955, 0.11087308824062347, -0.10852596163749695, 0.09316892176866531, 0.03191646933555603, -0.02453945018351078, -0.019108930602669716, -0.05796974152326584));
	r += mul(s2_7, min16float4x4(0.00575645687058568, 0.024252593517303467, 0.029844049364328384, 0.03137317672371864, -0.11251556128263474, -0.02456067129969597, 0.11153845489025116, -0.079093798995018, 0.13699184358119965, -0.21923606097698212, 0.005689297802746296, -0.18343617022037506, 0.020845666527748108, 0.04532851278781891, 0.16273395717144012, 0.16278128325939178));
	r += mul(s2_8, min16float4x4(0.009110871702432632, 0.00954681821167469, 0.005564331077039242, 0.008133471943438053, 0.029687682166695595, -0.027665600180625916, -0.01838764175772667, 0.08871924132108688, -0.037430912256240845, 0.024969428777694702, -0.0060448674485087395, 0.006218894384801388, 0.005758829414844513, 0.016784025356173515, 0.012186803855001926, 0.07528266310691833));
	r += mul(s3_0, min16float4x4(0.17328041791915894, -0.2875305116176605, -0.04841960594058037, -0.027573922649025917, 0.021296493709087372, -0.053286533802747726, 0.011901488527655602, -0.014460446313023567, 0.016797207295894623, 0.01742408610880375, 0.005063360091298819, 0.014396457932889462, -0.05332402512431145, 0.02191692590713501, -0.02212466299533844, 0.02372289076447487));
	r += mul(s3_1, min16float4x4(-0.7248479127883911, 1.222999930381775, -0.12331175059080124, 0.10394297540187836, 0.009892942383885384, 0.14685511589050293, 0.1293998658657074, 0.10801787674427032, 0.001443030429072678, -0.07543861865997314, -0.017625674605369568, 0.011626061052083969, -0.03158198669552803, 0.04282766953110695, 0.013101361691951752, 0.023064464330673218));
	r += mul(s3_2, min16float4x4(0.19216589629650116, -0.14111274480819702, 0.14272703230381012, -0.05529337376356125, 0.005108951590955257, -0.06472114473581314, 0.026610994711518288, 0.10826504230499268, 0.0028918557800352573, 0.020383205264806747, -0.04519973322749138, -0.049246545881032944, 0.026320843026041985, -0.012113037519156933, -0.0008035246864892542, 0.004338477272540331));
	r += mul(s3_3, min16float4x4(0.05931657925248146, -0.18051853775978088, 0.352590948343277, -0.4194057583808899, -0.0017515744548290968, 0.0028505981899797916, 0.007642603944987059, 0.010742231272161007, 0.04569941386580467, 0.06664840131998062, 0.027158664539456367, 0.040404804050922394, 0.3219922184944153, 0.2289002686738968, 0.0658840760588646, 0.10717743635177612));
	r += mul(s3_4, min16float4x4(-0.41511833667755127, 0.039964646100997925, -1.1135334968566895, 1.4464460611343384, 0.05994574725627899, 0.023507874459028244, 0.020347751677036285, 0.04675061255693436, -0.22093068063259125, 0.05164603143930435, -0.11830483376979828, -0.19425073266029358, 0.13919663429260254, -0.859297513961792, -0.14698447287082672, 0.018829165026545525));
	r += mul(s3_5, min16float4x4(0.13820518553256989, 0.07703710347414017, 0.2548868656158447, -0.050545793026685715, -0.07885745167732239, -0.013144275173544884, -0.09291515499353409, -0.1417936533689499, 0.13561877608299255, -0.22314466536045074, 0.18701162934303284, 0.08133724331855774, -0.11606904119253159, 0.12409113347530365, -0.01617804355919361, 0.013429854065179825));
	r += mul(s3_6, min16float4x4(-0.029219945892691612, 0.05631585791707039, -0.056972961872816086, 0.040562842041254044, -0.0011567604960873723, 0.005464476533234119, 0.0025245905853807926, 0.0015336530050262809, 0.0033578891307115555, 0.08228681236505508, 0.038373928517103195, 0.06116049736738205, 0.18833035230636597, -0.010429329238831997, 0.3569854497909546, 0.15277503430843353));
	r += mul(s3_7, min16float4x4(0.020339731127023697, 0.047683075070381165, 0.11069805920124054, -0.2030603587627411, 0.023752527311444283, 0.0033418929670006037, 0.025713317096233368, 0.006577592343091965, 0.40807396173477173, -0.25111642479896545, 0.20424792170524597, -0.1724724918603897, 0.7068495750427246, -0.9245385527610779, 1.1999517679214478, -1.7534719705581665));
	r += mul(s3_8, min16float4x4(-0.028785550966858864, -0.03896111994981766, -0.03042980469763279, 0.009168889373540878, -0.023132208734750748, -0.007440552581101656, -0.027249369770288467, -0.006532051134854555, -0.18573051691055298, 0.3423519730567932, -0.3682044744491577, 0.12881551682949066, -0.20425038039684296, 0.023840364068746567, -0.3349650204181671, 0.13932907581329346));
	r += float4(0.0008891178295016289, 0.0007173609919846058, 0.0007349895313382149, 0.0008138915291056037);
	return tanh(r);
}
void Pass3(uint2 blockStart, uint3 tid) {
	float2 pt = float2(GetInputPt());
	uint2 gxy = Rmp8x8(tid.x) + blockStart;
	uint2 size = GetInputSize();
	if (gxy.x >= size.x || gxy.y >= size.y) {
		return;
	}
	float2 pos = (gxy + 0.5) * pt;
	min16float4 s0_0 = l0(-1.0, -1.0);
	min16float4 s0_1 = l0(0.0, -1.0);
	min16float4 s0_2 = l0(1.0, -1.0);
	min16float4 s0_3 = l0(-1.0, 0.0);
	min16float4 s0_4 = l0(0.0, 0.0);
	min16float4 s0_5 = l0(1.0, 0.0);
	min16float4 s0_6 = l0(-1.0, 1.0);
	min16float4 s0_7 = l0(0.0, 1.0);
	min16float4 s0_8 = l0(1.0, 1.0);
	min16float4 s1_0 = max(-s0_0, 0.0);
	min16float4 s1_1 = max(-s0_1, 0.0);
	min16float4 s1_2 = max(-s0_2, 0.0);
	min16float4 s1_3 = max(-s0_3, 0.0);
	min16float4 s1_4 = max(-s0_4, 0.0);
	min16float4 s1_5 = max(-s0_5, 0.0);
	min16float4 s1_6 = max(-s0_6, 0.0);
	min16float4 s1_7 = max(-s0_7, 0.0);
	min16float4 s1_8 = max(-s0_8, 0.0);
	s0_0 = max(s0_0, 0.0);
	s0_1 = max(s0_1, 0.0);
	s0_2 = max(s0_2, 0.0);
	s0_3 = max(s0_3, 0.0);
	s0_4 = max(s0_4, 0.0);
	s0_5 = max(s0_5, 0.0);
	s0_6 = max(s0_6, 0.0);
	s0_7 = max(s0_7, 0.0);
	s0_8 = max(s0_8, 0.0);
	min16float4 s2_0 = l1(-1.0, -1.0);
	min16float4 s2_1 = l1(0.0, -1.0);
	min16float4 s2_2 = l1(1.0, -1.0);
	min16float4 s2_3 = l1(-1.0, 0.0);
	min16float4 s2_4 = l1(0.0, 0.0);
	min16float4 s2_5 = l1(1.0, 0.0);
	min16float4 s2_6 = l1(-1.0, 1.0);
	min16float4 s2_7 = l1(0.0, 1.0);
	min16float4 s2_8 = l1(1.0, 1.0);
	min16float4 s3_0 = max(-s2_0, 0.0);
	min16float4 s3_1 = max(-s2_1, 0.0);
	min16float4 s3_2 = max(-s2_2, 0.0);
	min16float4 s3_3 = max(-s2_3, 0.0);
	min16float4 s3_4 = max(-s2_4, 0.0);
	min16float4 s3_5 = max(-s2_5, 0.0);
	min16float4 s3_6 = max(-s2_6, 0.0);
	min16float4 s3_7 = max(-s2_7, 0.0);
	min16float4 s3_8 = max(-s2_8, 0.0);
	s2_0 = max(s2_0, 0.0);
	s2_1 = max(s2_1, 0.0);
	s2_2 = max(s2_2, 0.0);
	s2_3 = max(s2_3, 0.0);
	s2_4 = max(s2_4, 0.0);
	s2_5 = max(s2_5, 0.0);
	s2_6 = max(s2_6, 0.0);
	s2_7 = max(s2_7, 0.0);
	s2_8 = max(s2_8, 0.0);
	down[gxy] = f0(pt, pos, s0_0, s0_1, s0_2, s0_3, s0_4, s0_5, s0_6, s0_7, s0_8, s1_0, s1_1, s1_2, s1_3, s1_4, s1_5, s1_6, s1_7, s1_8, s2_0, s2_1, s2_2, s2_3, s2_4, s2_5, s2_6, s2_7, s2_8, s3_0, s3_1, s3_2, s3_3, s3_4, s3_5, s3_6, s3_7, s3_8);
}
//!PASS 4
//!DESC CuNNy-1x8C-BILINEAR-NVL-SH-shuffle
//!STYLE PS
//!IN down, INPUT
float4 Pass4(float2 pos) {
	float2 pt = float2(GetInputPt());
	const static float3x3 rgb2yuv = {0.299, 0.587, 0.114, -0.169, -0.331, 0.5, 0.5, -0.419, -0.081};
	const static float3x3 yuv2rgb = {1, -0.00093, 1.401687, 1, -0.3437, -0.71417, 1, 1.77216, 0.00099};
	float4 r = 0.0;
	float2 size = float2(GetInputSize());
	float2 f = frac(pos * size);
	float3 yuv = mul(rgb2yuv, INPUT.SampleLevel(SL, pos, 0).rgb);
	int2 i = int2(f * 2.0);
	r.r = down.SampleLevel(SP, (float2(0.5, 0.5) - f) * pt + pos, 0)[2*i.y + i.x];
	r.r += yuv.r;
	r.a = 1.0;
	r.r = clamp(r, 0.0, 1.0);
	float3 px = mul(yuv2rgb, float3(r.r, yuv.yz));
	return float4(px, 1.0);
}
