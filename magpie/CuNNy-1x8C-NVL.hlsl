// CuNNy 1x8C BILINEAR NVL
// Copyright (c) 2024 cunnyplapper

// This program is free software; you can redistribute it and/or
// modify it under the terms of the GNU Lesser General Public
// License as published by the Free Software Foundation; either
// version 3.0 of the License, or (at your option) any later version.
// 
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
// Lesser General Public License for more details.
// 
// You should have received a copy of the GNU Lesser General Public
// License along with this program.  If not, see <https://www.gnu.org/licenses/>.
/* ------------------------------------------------------------------- */

//!MAGPIE EFFECT
//!VERSION 3
//!OUTPUT_WIDTH INPUT_WIDTH * 2
//!OUTPUT_HEIGHT INPUT_HEIGHT * 2

//!TEXTURE
Texture2D INPUT;


//!SAMPLER
//!FILTER POINT
SamplerState SP;

//!SAMPLER
//!FILTER LINEAR
SamplerState SL;

//!TEXTURE
//!WIDTH INPUT_WIDTH
//!HEIGHT INPUT_HEIGHT
//!FORMAT R8G8B8A8_SNORM
Texture2D up_0;

//!TEXTURE
//!WIDTH INPUT_WIDTH
//!HEIGHT INPUT_HEIGHT
//!FORMAT R8G8B8A8_SNORM
Texture2D up_1;

//!TEXTURE
//!WIDTH INPUT_WIDTH
//!HEIGHT INPUT_HEIGHT
//!FORMAT R8G8B8A8_SNORM
Texture2D conv1_0;

//!TEXTURE
//!WIDTH INPUT_WIDTH
//!HEIGHT INPUT_HEIGHT
//!FORMAT R8G8B8A8_SNORM
Texture2D conv1_1;

//!TEXTURE
//!WIDTH INPUT_WIDTH
//!HEIGHT INPUT_HEIGHT
//!FORMAT R8G8B8A8_SNORM
Texture2D down;

//!PASS 1
//!DESC CuNNy-1x8C-BILINEAR-NVL-up
//!BLOCK_SIZE 8
//!NUM_THREADS 64
//!IN INPUT
//!OUT up_0, up_1
#define O(t, p) t.SampleLevel(SP, pos + p * pt, 0)
#define l0(x, y) dot(float3(0.299, 0.587, 0.114), O(INPUT, float2(x, y)).rgb)
float4 f0(float2 pt, float2 pos, min16float s0_0, min16float s0_1, min16float s0_2, min16float s0_3, min16float s0_4, min16float s0_5, min16float s0_6, min16float s0_7, min16float s0_8) {
	min16float4 r = 0.0;
	r += min16float4(0.010317151434719563, -0.007257288787513971, -0.17439548671245575, -0.014160899445414543) * s0_0;
	r += min16float4(-0.13374221324920654, -0.19284242391586304, 0.011021056212484837, 0.05701573193073273) * s0_1;
	r += min16float4(0.11889895796775818, 0.027672121301293373, 0.16455084085464478, -0.03962216526269913) * s0_2;
	r += min16float4(0.2208416759967804, 0.22301849722862244, -0.03332554176449776, 0.07542908191680908) * s0_3;
	r += min16float4(-0.2919921875, 0.15576171875, -0.20900070667266846, -0.3463469445705414) * s0_4;
	r += min16float4(-0.10791777819395065, -0.025207143276929855, 0.23505455255508423, -0.0548095628619194) * s0_5;
	r += min16float4(0.0016220803372561932, -0.21393415331840515, 0.10959950089454651, -0.0438108965754509) * s0_6;
	r += min16float4(0.18925602734088898, 0.03720974549651146, -0.007299093529582024, 0.2649196982383728) * s0_7;
	r += min16float4(-0.006820022128522396, -0.003998379688709974, -0.09543483704328537, 0.10098149627447128) * s0_8;
	r += float4(-0.00033535348484292626, -0.0011169473873451352, -0.000926250999327749, -0.0031679903622716665);
	return r;
}
float4 f1(float2 pt, float2 pos, min16float s0_0, min16float s0_1, min16float s0_2, min16float s0_3, min16float s0_4, min16float s0_5, min16float s0_6, min16float s0_7, min16float s0_8) {
	min16float4 r = 0.0;
	r += min16float4(-0.0019246310694143176, -0.21826171875, 0.04008013755083084, 0.01731649972498417) * s0_0;
	r += min16float4(0.0023975179065018892, -0.08756864815950394, -0.07623562216758728, -0.014598770998418331) * s0_1;
	r += min16float4(-0.001107927062548697, 0.13702070713043213, -0.31804579496383667, 0.04631953313946724) * s0_2;
	r += min16float4(0.00011616930714808404, -0.07901100814342499, -0.045211050659418106, 0.1352539360523224) * s0_3;
	r += min16float4(0.32488954067230225, 0.24196137487888336, 0.027641475200653076, -0.39313173294067383) * s0_4;
	r += min16float4(-0.32324206829071045, 0.01422295905649662, 0.37550243735313416, 0.15916815400123596) * s0_5;
	r += min16float4(0.0043899803422391415, 0.1284179538488388, 0.00444549135863781, 0.036663152277469635) * s0_6;
	r += min16float4(-0.003885887796059251, -0.0017972055356949568, 0.025001544505357742, -0.018085086718201637) * s0_7;
	r += min16float4(-0.0014607132179662585, -0.1362304389476776, -0.03204343840479851, 0.027244605123996735) * s0_8;
	r += float4(0.00033718187478370965, 0.001833153422921896, 0.0019108577398583293, -0.0007238442194648087);
	return r;
}
void Pass1(uint2 blockStart, uint3 tid) {
	float2 pt = float2(GetInputPt());
	uint2 gxy = Rmp8x8(tid.x) + blockStart;
	uint2 size = GetInputSize();
	if (gxy.x >= size.x || gxy.y >= size.y) {
		return;
	}
	float2 pos = (gxy + 0.5) * pt;
	min16float s0_0 = l0(-1.0, -1.0);
	min16float s0_1 = l0(0.0, -1.0);
	min16float s0_2 = l0(1.0, -1.0);
	min16float s0_3 = l0(-1.0, 0.0);
	min16float s0_4 = l0(0.0, 0.0);
	min16float s0_5 = l0(1.0, 0.0);
	min16float s0_6 = l0(-1.0, 1.0);
	min16float s0_7 = l0(0.0, 1.0);
	min16float s0_8 = l0(1.0, 1.0);
	up_0[gxy] = f0(pt, pos, s0_0, s0_1, s0_2, s0_3, s0_4, s0_5, s0_6, s0_7, s0_8);
	up_1[gxy] = f1(pt, pos, s0_0, s0_1, s0_2, s0_3, s0_4, s0_5, s0_6, s0_7, s0_8);
}
//!PASS 2
//!DESC CuNNy-1x8C-BILINEAR-NVL-conv1
//!BLOCK_SIZE 8
//!NUM_THREADS 64
//!IN up_0, up_1
//!OUT conv1_0, conv1_1
#define O(t, p) t.SampleLevel(SP, pos + p * pt, 0)
#define l0(x, y) O(up_0, float2(x, y))
#define l1(x, y) O(up_1, float2(x, y))
float4 f0(float2 pt, float2 pos, min16float4 s0_0, min16float4 s0_1, min16float4 s0_2, min16float4 s0_3, min16float4 s0_4, min16float4 s0_5, min16float4 s0_6, min16float4 s0_7, min16float4 s0_8, min16float4 s1_0, min16float4 s1_1, min16float4 s1_2, min16float4 s1_3, min16float4 s1_4, min16float4 s1_5, min16float4 s1_6, min16float4 s1_7, min16float4 s1_8, min16float4 s2_0, min16float4 s2_1, min16float4 s2_2, min16float4 s2_3, min16float4 s2_4, min16float4 s2_5, min16float4 s2_6, min16float4 s2_7, min16float4 s2_8, min16float4 s3_0, min16float4 s3_1, min16float4 s3_2, min16float4 s3_3, min16float4 s3_4, min16float4 s3_5, min16float4 s3_6, min16float4 s3_7, min16float4 s3_8) {
	min16float4 r = 0.0;
	r += mul(s0_0, min16float4x4(-0.11895542591810226, 0.19931314885616302, 0.21332530677318573, 0.04183194041252136, -0.009605344384908676, -0.16494929790496826, -0.12869441509246826, 0.0225057490170002, 0.05296026170253754, -0.11944178491830826, -0.05069692060351372, 0.004068349953740835, -0.25122368335723877, 0.2665899395942688, 0.35603174567222595, 0.27947691082954407));
	r += mul(s0_1, min16float4x4(-0.20393814146518707, 0.08045010268688202, 0.06409744173288345, -0.18217116594314575, -0.04461707919836044, 0.057664453983306885, -0.20370998978614807, -0.016268523409962654, -0.1548445075750351, -0.05845705792307854, -0.11570755392313004, -0.1451123207807541, -0.25996288657188416, 0.3971761167049408, 0.11750225722789764, -0.37242913246154785));
	r += mul(s0_2, min16float4x4(-0.3245956599712372, -0.021869931370019913, -0.01830076053738594, 0.2578210234642029, 0.06770865619182587, -0.3599436581134796, -0.17428669333457947, 0.16883504390716553, -0.09163564443588257, -0.19096499681472778, -0.10774507373571396, 0.19020019471645355, -0.04957401752471924, 0.20463353395462036, 0.8646000027656555, 0.12751124799251556));
	r += mul(s0_3, min16float4x4(0.013339736498892307, -0.034793492406606674, 0.02858305163681507, 0.031917132437229156, 0.07968916743993759, -0.1053721159696579, -0.043226152658462524, -0.051646288484334946, 0.0670963004231453, -0.1598448008298874, -0.0523533895611763, -0.1059548482298851, 0.211328387260437, -0.05061257630586624, 0.08364962041378021, 0.1900652050971985));
	r += mul(s0_4, min16float4x4(0.5473004579544067, -0.6089820861816406, -0.22288654744625092, -0.4905166029930115, -0.4929159879684448, 0.09071647375822067, -0.02444189228117466, -0.0693882405757904, 0.16312740743160248, -0.3617970943450928, -0.08990390598773956, -0.0379953533411026, 0.09162213653326035, -1.2147806882858276, 0.6728355884552002, -0.11461953818798065));
	r += mul(s0_5, min16float4x4(-0.256517231464386, 0.039511632174253464, -0.15771417319774628, -0.21224814653396606, -0.9134316444396973, -0.25913095474243164, -0.3973637819290161, -0.04844716563820839, -0.16375692188739777, 0.19910317659378052, -0.06334579735994339, -0.2744387090206146, 0.0352553129196167, 0.055865053087472916, -0.2039152830839157, -0.07535398006439209));
	r += mul(s0_6, min16float4x4(-0.0459466427564621, -0.12082646787166595, -0.1363397240638733, 0.1236913800239563, 0.17813783884048462, -0.026259928941726685, 0.017016395926475525, 0.00044737683492712677, -0.2317805141210556, -0.08994526416063309, -0.061435990035533905, 0.07370419055223465, -0.09723668545484543, 0.07296749949455261, -0.023627938702702522, -0.1130128726363182));
	r += mul(s0_7, min16float4x4(-0.22018364071846008, -0.25041714310646057, -0.11905455589294434, 0.10308842360973358, 0.12173555046319962, -0.2831965386867523, -0.136636883020401, -0.05910620093345642, -0.5060818195343018, 0.04007803276181221, 0.12459122389554977, -0.02963385544717312, -0.04387274757027626, 0.13722248375415802, 0.43209975957870483, 0.003569971304386854));
	r += mul(s0_8, min16float4x4(-0.24764296412467957, -0.2295781821012497, -0.20233558118343353, 0.08129607141017914, 0.0752013772726059, -0.10048934817314148, -0.34233784675598145, 0.19579847157001495, 0.05553285405039787, -0.05401787534356117, -0.07420095056295395, 0.035539306700229645, 0.18332913517951965, -0.03658081963658333, -0.0712842121720314, 0.016104210168123245));
	r += mul(s1_0, min16float4x4(-0.06308379769325256, -0.1461576372385025, -0.20361240208148956, 0.1058444231748581, -0.20071856677532196, 0.1336650848388672, -0.01140176597982645, -0.09884826093912125, 0.09627470374107361, 0.0016710030613467097, 0.06803762912750244, 0.015924926847219467, 0.12455863505601883, -0.053396597504615784, -0.10896512866020203, 0.06577499955892563));
	r += mul(s1_1, min16float4x4(-0.02168654091656208, -0.17919498682022095, -0.21600867807865143, 0.26834720373153687, -0.16466955840587616, 0.04288293048739433, -0.028202423825860023, -0.06134795397520065, 0.1401914805173874, -0.3232421278953552, -0.012792837806046009, 0.16943348944187164, 0.10287712514400482, -0.5189447402954102, 0.4042831361293793, 0.31826403737068176));
	r += mul(s1_2, min16float4x4(0.208591490983963, 0.09372860938310623, -0.09656485915184021, -0.3111473023891449, 0.12962163984775543, -0.20921458303928375, -0.3447103798389435, 0.06718186289072037, 0.04501489922404289, 0.006729463580995798, -0.11544369906187057, -0.18212661147117615, 0.014027338474988937, -0.11331377178430557, -0.36019107699394226, -0.21632970869541168));
	r += mul(s1_3, min16float4x4(-0.001084826304577291, -0.04681890085339546, -0.08584003150463104, -0.056517500430345535, -0.020042093470692635, 0.10823320597410202, -0.005911655258387327, 0.07574017345905304, 0.10137132555246353, -0.295908123254776, -0.10100513696670532, -0.04525470361113548, 0.3893510401248932, -0.006460751406848431, 0.03418907895684242, 0.15727223455905914));
	r += mul(s1_4, min16float4x4(0.17132587730884552, 0.10872586071491241, 0.010071611031889915, -0.23527301847934723, -0.2841576635837555, 0.14728982746601105, 0.021772369742393494, -0.3709684908390045, 0.028872910887002945, -0.25223246216773987, 0.03961632773280144, -0.2092747539281845, -0.18687686324119568, 0.127399742603302, 0.4073404371738434, -0.16771593689918518));
	r += mul(s1_5, min16float4x4(0.0008310723933391273, -0.11619815975427628, -0.03622545674443245, 0.3090725839138031, -0.1591150164604187, -0.5915126204490662, -0.13484664261341095, 0.18012285232543945, -0.04110300540924072, -0.2042498141527176, -0.2954903244972229, -0.012374612502753735, -0.23517850041389465, -0.02788723073899746, -0.06462002545595169, 0.103144571185112));
	r += mul(s1_6, min16float4x4(-0.06834134459495544, 0.11739645153284073, 0.07205275446176529, 0.11293257027864456, 0.06041361391544342, 0.015355550684034824, -0.0783509686589241, -0.04044754430651665, -0.3302963078022003, 0.08496566861867905, -0.15017728507518768, 0.08151046931743622, -0.1371220350265503, -0.04718881845474243, 0.037580449134111404, 0.06541909277439117));
	r += mul(s1_7, min16float4x4(0.11961042881011963, 0.08283385634422302, 0.1349981278181076, -0.2392975091934204, 0.23224933445453644, 0.10165856778621674, 0.1251637190580368, -0.10546626895666122, -0.18994593620300293, -0.00456793699413538, -0.07204096764326096, 0.0823746994137764, 0.0006729583255946636, 0.006885747890919447, -0.061441633850336075, 0.08110805600881577));
	r += mul(s1_8, min16float4x4(0.025286003947257996, 0.14476783573627472, -0.2854536771774292, 0.04797894135117531, 0.24063357710838318, 0.07677040249109268, -0.20922957360744476, -0.18892449140548706, -0.21728728711605072, 0.12475479394197464, 0.0721931904554367, -0.12325568497180939, -0.14062802493572235, 0.006435345392674208, 0.2928806245326996, -0.17729230225086212));
	r += mul(s2_0, min16float4x4(-0.5635684728622437, 0.2033105194568634, -0.17798875272274017, -0.12304861843585968, 0.016882143914699554, 0.11107874661684036, 0.06467489898204803, 0.010775505565106869, 0.10357102751731873, -0.07421936839818954, 0.03267157822847366, 0.08290882408618927, 0.3486386239528656, -0.2723746597766876, -0.3126612901687622, -0.23297563195228577));
	r += mul(s2_1, min16float4x4(-0.10847735404968262, 0.2585357129573822, -0.05997999757528305, -0.012286348268389702, 0.02670232765376568, 0.04300779104232788, 0.1420978307723999, 0.023131994530558586, -0.013680456206202507, 0.16842029988765717, 0.1703168749809265, -0.25878891348838806, 0.8049270510673523, -0.3795372247695923, 0.10024724155664444, 0.060627661645412445));
	r += mul(s2_2, min16float4x4(-0.13720719516277313, 0.0673992782831192, 0.07502154260873795, 0.09367689490318298, 0.060060176998376846, 0.09889226406812668, -0.019797835499048233, -0.07348140329122543, -0.14467723667621613, -0.012923690490424633, -0.04512458294630051, 0.12841759622097015, 0.19086159765720367, -0.14629682898521423, 0.013818767853081226, -0.2921146750450134));
	r += mul(s2_3, min16float4x4(0.14048564434051514, 0.24863244593143463, -0.06776496767997742, 0.05492905154824257, 0.029971839860081673, 0.08485861122608185, 0.23006747663021088, 0.04453110322356224, -0.6284515261650085, -0.010442188940942287, -0.02972409874200821, 0.12036348879337311, -0.10290110111236572, -0.010556644760072231, 0.026807812973856926, -0.16522911190986633));
	r += mul(s2_4, min16float4x4(0.07337768375873566, 0.01435247901827097, 0.09630529582500458, 0.14507827162742615, -0.19564861059188843, 0.1484922468662262, 0.09295821934938431, 0.13422457873821259, 0.1256982833147049, 0.07909426838159561, 0.13758663833141327, 0.02681649662554264, -0.6383588314056396, -1.0113136768341064, -0.26359689235687256, 1.0664094686508179));
	r += mul(s2_5, min16float4x4(0.15715889632701874, -0.0801500678062439, 0.21533186733722687, 0.11241137236356735, 0.04597276821732521, 0.009906597435474396, 0.18021216988563538, -0.004175171721726656, -0.010339192114770412, -0.0637562945485115, -0.09058159589767456, -0.09478054195642471, -0.10911541432142258, 0.02847256511449814, -0.09955283999443054, -0.2605800926685333));
	r += mul(s2_6, min16float4x4(0.15704487264156342, -0.12562623620033264, 0.25025674700737, -0.24517664313316345, 0.17155523598194122, 0.00980786420404911, 0.17844931781291962, 0.03220687061548233, -0.06592919677495956, -0.1851530820131302, 0.04702688008546829, -0.09969348460435867, -0.06388963013887405, 0.07175420969724655, 0.03657657280564308, -0.15088671445846558));
	r += mul(s2_7, min16float4x4(0.27146100997924805, 0.09807320684194565, -0.023190172389149666, -0.17087027430534363, 0.1382947713136673, -0.23758868873119354, -0.04095127061009407, 0.24635913968086243, 0.22804269194602966, -0.22972515225410461, 0.6685547232627869, 0.28222692012786865, -0.08658698946237564, 0.21660970151424408, -0.03774331137537956, 0.16638223826885223));
	r += mul(s2_8, min16float4x4(-0.019697312265634537, -0.13350337743759155, -0.16456638276576996, 0.1529742181301117, 0.059896815568208694, 0.11690730601549149, 0.2713231146335602, 0.07345066964626312, -0.03492185100913048, -0.14796486496925354, 0.09800649434328079, -0.05430900678038597, -0.11337698251008987, 0.08640347421169281, 0.03067740611732006, -0.08612149208784103));
	r += mul(s3_0, min16float4x4(-0.3131093680858612, 0.25700843334198, -0.03261583298444748, -0.21329502761363983, -0.14265087246894836, 0.0181475467979908, 0.029186535626649857, 0.0033967960625886917, -0.06831435859203339, 0.0990418866276741, -0.08156517148017883, -0.030904145911335945, -0.028122371062636375, 0.025341659784317017, -0.02363145537674427, -0.09999105334281921));
	r += mul(s3_1, min16float4x4(-0.6712329983711243, 0.47228530049324036, -0.13492614030838013, 0.33471769094467163, 0.06847697496414185, 0.23084621131420135, 0.12936893105506897, -0.04919856786727905, -0.15298661589622498, 0.12906159460544586, 0.24573926627635956, 0.13136376440525055, -0.07659775018692017, 0.10176306217908859, 0.15007007122039795, -0.10894416272640228));
	r += mul(s3_2, min16float4x4(0.18115392327308655, 0.06333212554454803, 0.09169483929872513, 0.24645553529262543, 0.09608808904886246, -0.0884973406791687, 0.15485544502735138, 0.11200064420700073, 0.06865295022726059, 0.06849582493305206, 0.0939396545290947, -0.12517710030078888, 0.07654079794883728, 0.11961594969034195, 0.02685943990945816, 0.07011297345161438));
	r += mul(s3_3, min16float4x4(0.010512237437069416, 0.24877086281776428, 0.3067345917224884, -0.5373996496200562, -0.004628514405339956, 0.1638641208410263, 0.02480822615325451, 0.14292508363723755, -0.04480575770139694, 0.21388043463230133, 0.5761247277259827, 1.1349081993103027, -0.01534593477845192, 0.061911847442388535, -0.06229722499847412, -0.07972971349954605));
	r += mul(s3_4, min16float4x4(0.46077293157577515, -2.1565990447998047, -0.014521637931466103, 1.588226079940796, 0.057368356734514236, 0.14360864460468292, 0.560982346534729, 0.1156475767493248, 0.03086160309612751, -0.1179007962346077, 0.6219578385353088, 0.6109028458595276, -0.29622218012809753, -0.012607959099113941, -0.20104120671749115, 0.05764496326446533));
	r += mul(s3_5, min16float4x4(0.0661894753575325, -0.05000993609428406, 0.25950220227241516, 0.1709301471710205, 0.11787501722574234, 0.09374365955591202, 0.4467504918575287, 0.1147710308432579, -0.008970629423856735, 0.09883008152246475, 0.25423872470855713, -0.015413062646985054, -0.08451380580663681, 0.13564853370189667, 0.030724067240953445, -0.10872215032577515));
	r += mul(s3_6, min16float4x4(0.05068787932395935, -0.09933853894472122, 0.06136205792427063, -0.15395987033843994, 0.02380538173019886, 0.027152393013238907, 0.14964134991168976, -0.052426233887672424, 0.13741521537303925, -0.19189535081386566, -0.026897456496953964, -0.7264425158500671, 0.021583760157227516, 0.009550079703330994, 0.012569649145007133, -0.09393805265426636));
	r += mul(s3_7, min16float4x4(-0.5635359287261963, -0.27299290895462036, 0.24043017625808716, -0.16282735764980316, 0.02428525499999523, 0.28168562054634094, 0.380305677652359, -0.175411194562912, 0.13119080662727356, -0.08377205580472946, -0.05647093057632446, -0.08387123048305511, -0.03522312641143799, 0.07495684176683426, -0.025671811774373055, 0.020152224227786064));
	r += mul(s3_8, min16float4x4(-0.05529918149113655, 0.035600751638412476, -0.11372187733650208, 0.09612879902124405, -0.04346785694360733, -0.009306688793003559, 0.19286960363388062, 0.05309487506747246, 0.19077177345752716, 0.04799111187458038, 0.14121408760547638, -0.06625926494598389, 0.22017300128936768, 0.020448453724384308, 0.12267684191465378, -0.0385894738137722));
	r += float4(-0.0040499684400856495, -0.0038449487183243036, 0.0015902630984783173, 0.002172116655856371);
	return r;
}
float4 f1(float2 pt, float2 pos, min16float4 s0_0, min16float4 s0_1, min16float4 s0_2, min16float4 s0_3, min16float4 s0_4, min16float4 s0_5, min16float4 s0_6, min16float4 s0_7, min16float4 s0_8, min16float4 s1_0, min16float4 s1_1, min16float4 s1_2, min16float4 s1_3, min16float4 s1_4, min16float4 s1_5, min16float4 s1_6, min16float4 s1_7, min16float4 s1_8, min16float4 s2_0, min16float4 s2_1, min16float4 s2_2, min16float4 s2_3, min16float4 s2_4, min16float4 s2_5, min16float4 s2_6, min16float4 s2_7, min16float4 s2_8, min16float4 s3_0, min16float4 s3_1, min16float4 s3_2, min16float4 s3_3, min16float4 s3_4, min16float4 s3_5, min16float4 s3_6, min16float4 s3_7, min16float4 s3_8) {
	min16float4 r = 0.0;
	r += mul(s0_0, min16float4x4(-0.046193040907382965, 0.1190362274646759, -0.08518625050783157, 0.16722266376018524, 0.13043074309825897, -0.0011188446078449488, 0.14855533838272095, 0.007111321669071913, 0.146967813372612, 0.04328383132815361, -0.03607296198606491, 0.09744052588939667, -0.03596049174666405, 0.25181251764297485, -0.09592791646718979, 0.19482018053531647));
	r += mul(s0_1, min16float4x4(0.10756532102823257, -0.48143747448921204, 0.060167938470840454, -0.23983536660671234, 0.07585636526346207, 0.15380720794200897, -0.0993502140045166, -0.05236199498176575, -0.06680981069803238, -0.2413976788520813, -0.01351539883762598, -0.213816300034523, -0.21489466726779938, -0.46123382449150085, 0.15072228014469147, -0.37873202562332153));
	r += mul(s0_2, min16float4x4(-0.1579139232635498, 0.001224054372869432, -0.16618213057518005, -0.07369137555360794, 0.42607319355010986, -0.17983724176883698, 0.140141561627388, -0.025219259783625603, 0.04344110190868378, 0.07060323655605316, -0.0806398019194603, 0.1248449832201004, -0.01877037063241005, 0.10086295753717422, -0.014066968113183975, 0.1772516816854477));
	r += mul(s0_3, min16float4x4(0.16550081968307495, -0.028688404709100723, -0.24389813840389252, 0.025398608297109604, 0.005518273450434208, -0.03836093842983246, 0.11272774636745453, 0.05408120155334473, 0.017748447135090828, -0.02669033221900463, 0.14419977366924286, -0.35041365027427673, 0.11964815109968185, 0.0657161995768547, 0.024088328704237938, 0.30619868636131287));
	r += mul(s0_4, min16float4x4(0.6855484247207642, -0.1015963926911354, -0.39472001791000366, 0.0026510099414736032, 0.08200877904891968, 0.21540352702140808, -0.4114639163017273, -0.1378180831670761, 0.07626421004533768, 0.010942231863737106, 0.10175315290689468, -0.16860811412334442, 0.4476487338542938, 0.5337287187576294, -0.34932804107666016, 0.22866091132164001));
	r += mul(s0_5, min16float4x4(-0.21728543937206268, -0.13214854896068573, 0.028120441362261772, -0.17781169712543488, -0.025072285905480385, -0.22721193730831146, 0.5402722358703613, -0.17621007561683655, 0.3759213089942932, -0.05366910621523857, -0.22970615327358246, -0.10792690515518188, -0.22610163688659668, -0.014145896770060062, -0.24444074928760529, -0.014911978505551815));
	r += mul(s0_6, min16float4x4(-0.0011633912799879909, 0.08815441280603409, -0.20424769818782806, 0.2939121425151825, -0.011007902212440968, 0.03687262535095215, 0.004495145753026009, 0.06274454295635223, 0.04192700982093811, 0.026376403868198395, 0.009566671214997768, 0.12674559652805328, -0.03911649435758591, 0.13143174350261688, 0.18895204365253448, -0.184861421585083));
	r += mul(s0_7, min16float4x4(0.11609040945768356, -0.14191319048404694, -0.33388227224349976, 0.2265981286764145, 0.06501909345388412, -0.06323549896478653, -0.16192160546779633, 0.034059420228004456, -0.07888220250606537, -0.14390552043914795, 0.07286572456359863, 0.058403413742780685, -0.3581913709640503, 0.14795303344726562, 0.0778031051158905, -0.059815116226673126));
	r += mul(s0_8, min16float4x4(0.0690917894244194, 0.016677046194672585, 0.5377649068832397, 0.06864424794912338, 0.2688394784927368, 0.011668163351714611, 0.17235030233860016, 0.10686153918504715, 0.026000676676630974, 0.10924208164215088, -0.2282106727361679, -0.023009680211544037, 0.2384410947561264, -0.03645819425582886, -0.3678346574306488, 3.5110274438920897e-06));
	r += mul(s1_0, min16float4x4(0.0513024665415287, -0.013606864027678967, -0.02670236863195896, 0.0210434440523386, -0.015295413322746754, -0.1573331654071808, -0.07855639606714249, -0.0708659291267395, -0.07631108164787292, 0.07138381153345108, -0.032903265208005905, -0.01436047162860632, 0.08666697144508362, 0.16030091047286987, 0.2263777107000351, 0.2545850872993469));
	r += mul(s1_1, min16float4x4(0.004333077929913998, 0.434744268655777, -0.1412358582019806, 0.2665753960609436, 0.09614673256874084, -0.26554736495018005, -0.0648345798254013, 0.08750230818986893, 0.12974776327610016, 0.15882772207260132, -0.07546527683734894, 0.1681137979030609, 0.33952614665031433, 0.9197995066642761, -0.47640150785446167, 0.37370458245277405));
	r += mul(s1_2, min16float4x4(0.26046130061149597, -0.07788248360157013, 0.07792236655950546, 0.003578230505809188, -0.09662964195013046, 0.07312518358230591, 0.11547145992517471, 0.15805219113826752, 0.13024255633354187, -0.14207987487316132, 0.023343810811638832, -0.05432684347033501, 0.18857428431510925, -0.15444843471050262, -0.39225515723228455, -0.2932153642177582));
	r += mul(s1_3, min16float4x4(0.04913106933236122, -0.10766925662755966, 0.02250003255903721, 0.06521471589803696, 0.18213889002799988, 0.0029569321777671576, -0.12743163108825684, 0.051696907728910446, -0.038921061903238297, -0.07587356865406036, -0.09108508378267288, 0.06371881067752838, -0.21141093969345093, 0.15923026204109192, 0.1879318654537201, 0.026993142440915108));
	r += mul(s1_4, min16float4x4(0.008219811134040356, -0.10678452253341675, -0.19931577146053314, -0.08095064759254456, -0.03753884881734848, 0.16866180300712585, -0.0726509839296341, -0.08523312956094742, 0.09951846301555634, -0.1340407282114029, -0.14259347319602966, -0.1713866889476776, -0.2103545367717743, 0.04040483757853508, 0.16053757071495056, -0.06395958364009857));
	r += mul(s1_5, min16float4x4(0.39941686391830444, 0.11890798062086105, -0.7519508004188538, 0.24683518707752228, 0.41695892810821533, -0.3641790449619293, -0.06491155922412872, -0.1676444411277771, 0.22900009155273438, 0.03491160273551941, -0.2830972373485565, 0.09754852950572968, 0.0934469923377037, -0.0891089141368866, 0.06643881648778915, 0.026545720174908638));
	r += mul(s1_6, min16float4x4(0.17260506749153137, -0.08513262867927551, 0.10061439871788025, -0.09060967713594437, 0.04626629501581192, -0.02993950992822647, -0.01807146891951561, -0.022417349740862846, 0.03056688793003559, -0.19245120882987976, 0.12476395070552826, -0.07984314858913422, -0.07169772684574127, 0.01739262044429779, -0.007019189652055502, 0.022383779287338257));
	r += mul(s1_7, min16float4x4(0.14892594516277313, -0.22125498950481415, -0.0284560713917017, -0.19454039633274078, 0.06728746742010117, -0.16169984638690948, -0.06514739245176315, -0.20208798348903656, -0.05053073912858963, 0.14791734516620636, -0.01976405829191208, 0.20421576499938965, -0.13710549473762512, 0.12430589646100998, -0.007723306771367788, 0.10368507355451584));
	r += mul(s1_8, min16float4x4(0.27831974625587463, -0.025784634053707123, -0.5410159230232239, 0.053842492401599884, 0.15255223214626312, -0.19189785420894623, 0.10464274138212204, -0.10751812905073166, 0.007146656513214111, -0.06842464953660965, -0.010670552030205727, 0.02815805748105049, -0.2531086802482605, 0.026429438963532448, 0.29994794726371765, -0.11596820503473282));
	r += mul(s2_0, min16float4x4(0.03477085009217262, -0.3564908802509308, -0.20937760174274445, -0.17247605323791504, -0.14208827912807465, 0.05209715664386749, 0.036420006304979324, 0.0033962226007133722, 0.0046659973450005054, 0.15091490745544434, -0.014339924789965153, 0.10178576409816742, 0.06257085502147675, -0.0806998461484909, 0.17553649842739105, -0.36497771739959717));
	r += mul(s2_1, min16float4x4(0.15503597259521484, -0.06726981699466705, 0.09235794097185135, 0.04414539784193039, -0.03656541183590889, 0.011410277336835861, -0.12148809432983398, 0.00871889665722847, -0.1517031490802765, -0.0905100479722023, 0.01763431541621685, -0.023880597203969955, -0.061737362295389175, 0.22201122343540192, 0.030778983607888222, 0.06810375303030014));
	r += mul(s2_2, min16float4x4(-0.17233334481716156, 0.04417451471090317, 0.3277237117290497, 0.07947737723588943, -0.06505385786294937, -0.08666980266571045, 0.08285746723413467, -0.03771147131919861, -0.07748685777187347, -0.008755624294281006, -0.10299292206764221, -0.01584244892001152, -0.16487932205200195, -0.07352762669324875, -0.3215540647506714, -0.329301118850708));
	r += mul(s2_3, min16float4x4(-0.13606680929660797, 0.4978545904159546, -1.0122634172439575, 1.4177852869033813, -0.09744085371494293, 0.07495340704917908, 0.03586120903491974, 0.10234102606773376, 0.13808573782444, -0.09902193397283554, 0.010199878364801407, 0.12101506441831589, -0.2589982748031616, -0.09641746431589127, 0.38216713070869446, -0.12772339582443237));
	r += mul(s2_4, min16float4x4(-0.3011865019798279, -0.015278995968401432, 0.02191389910876751, -0.2872101366519928, -0.30557698011398315, 0.10129756480455399, 0.24023619294166565, 0.0063611045479774475, -0.11947370320558548, 0.06106041744351387, -0.0009670166182331741, 0.09787435084581375, -0.4563584625720978, -0.32720866799354553, 0.817137598991394, 1.1498491764068604));
	r += mul(s2_5, min16float4x4(-0.06842740625143051, 0.04739841818809509, 0.10214699059724808, -0.059081338346004486, 0.04969392344355583, 0.1113024353981018, -0.2822287976741791, 0.06683807820081711, 0.06710124015808105, -0.07202348113059998, -0.0783199891448021, -0.12841834127902985, -0.22003497183322906, 0.04776475578546524, -0.7099071741104126, -0.587215781211853));
	r += mul(s2_6, min16float4x4(-0.08245395869016647, 0.06811103969812393, -0.2534787356853485, -0.38572391867637634, -0.1346653550863266, 0.05495506525039673, 0.01169425155967474, -0.049602434039115906, -0.23768222332000732, 0.309622198343277, 0.07808127999305725, -0.42154553532600403, 0.035933591425418854, -0.16122254729270935, 0.15526840090751648, -0.1943378746509552));
	r += mul(s2_7, min16float4x4(-0.07299764454364777, 0.04074232280254364, 0.010484679602086544, -0.037357546389102936, -0.026928918436169624, 0.16306468844413757, 0.015481406822800636, 0.08612850308418274, -0.18350069224834442, 0.19842121005058289, 0.4758962392807007, 0.32767707109451294, 0.17423421144485474, 0.052166689187288284, -0.05548059195280075, 0.19938819110393524));
	r += mul(s2_8, min16float4x4(-0.06453074514865875, -0.018835121765732765, 0.18306826055049896, -0.002109016990289092, -0.26863929629325867, 0.06305406242609024, -0.061519574373960495, 0.0576820969581604, 0.0235618744045496, -0.022821104153990746, -0.06686388701200485, -0.11710987985134125, -0.43240097165107727, -0.17401066422462463, 0.24658207595348358, -0.23822316527366638));
	r += mul(s3_0, min16float4x4(-0.26093289256095886, -0.2223779857158661, -0.1391628235578537, 0.13345737755298615, 0.012109617702662945, -0.030441889539361, -0.003766697598621249, -0.014003437012434006, 0.0063577271066606045, -0.050993286073207855, -0.07728425413370132, -0.11751990020275116, 0.06417630612850189, -0.15710744261741638, -0.09646985679864883, -0.03678284212946892));
	r += mul(s3_1, min16float4x4(-0.4541016221046448, 0.26969194412231445, -0.04289032146334648, -0.10192500054836273, -0.13328255712985992, 0.22679437696933746, 0.14856469631195068, 0.009472761303186417, 0.02166721038520336, 0.004601671826094389, -0.16034971177577972, -0.007509960792958736, 0.04944067820906639, -0.16370126605033875, 0.18644066154956818, -0.014025604352355003));
	r += mul(s3_2, min16float4x4(0.05039996653795242, 0.055488839745521545, 0.5878905057907104, 0.22502242028713226, -0.11036644130945206, 0.12549710273742676, 0.15636996924877167, 0.01364373043179512, 0.06426666676998138, 0.027785524725914, 0.010209191590547562, 0.0344463475048542, -0.037246767431497574, 0.12160210311412811, -0.03761307895183563, -0.039691001176834106));
	r += mul(s3_3, min16float4x4(-0.14002835750579834, 0.20103226602077484, -0.3441336154937744, 0.2986801564693451, -0.029995683580636978, 0.0967748612165451, -0.02732565440237522, 0.07811310142278671, 0.23199401795864105, 2.1579127311706543, -0.29561224579811096, 1.0446871519088745, 0.04684232547879219, 0.054515961557626724, -0.09300855547189713, 0.06523440033197403));
	r += mul(s3_4, min16float4x4(0.08035580068826675, 0.23148754239082336, -0.6940996646881104, -0.5449222922325134, -0.5562058687210083, 0.3549581468105316, -0.03303363174200058, 0.43237611651420593, -0.7263609766960144, 0.04449906200170517, 0.6503890752792358, 0.48694247007369995, 0.05438089370727539, 0.032894134521484375, -0.1610904335975647, 0.028986386954784393));
	r += mul(s3_5, min16float4x4(-0.5231721997261047, -0.06682479381561279, 0.5787109136581421, 0.27019745111465454, -0.9537152051925659, 0.14889448881149292, 0.3346104323863983, -0.15058863162994385, -0.0788586363196373, 0.025386929512023926, -0.0490800216794014, 0.07174494862556458, 0.15429900586605072, -0.08346125483512878, -0.18621040880680084, -0.026493186131119728));
	r += mul(s3_6, min16float4x4(-0.2692745625972748, 0.029881486669182777, -0.07397843897342682, -0.20925627648830414, -0.010797213762998581, 0.1528121381998062, -0.07265623658895493, -0.060315899550914764, -0.16140896081924438, -0.010689741931855679, -0.01908784732222557, -0.6258116960525513, -0.19580458104610443, 0.15577177703380585, -0.14207933843135834, 0.003364030970260501));
	r += mul(s3_7, min16float4x4(-0.3006821572780609, 0.11983971297740936, 0.01914162002503872, -0.3269537389278412, -0.29954397678375244, 0.09375232458114624, 0.08339668065309525, -0.12228527665138245, 0.3555518686771393, 0.05435151234269142, -0.31214118003845215, -0.09895757585763931, 0.03073139488697052, -0.08178649842739105, 0.1284186840057373, 0.05067168176174164));
	r += mul(s3_8, min16float4x4(0.5525557994842529, 0.03629446029663086, 0.13486389815807343, 0.3852636218070984, -0.31874677538871765, 0.12383978813886642, 0.23928771913051605, -0.04998989403247833, -0.05436064302921295, -0.000216816712054424, -0.11957556009292603, -0.020595107227563858, -0.0983884334564209, 0.08100048452615738, -0.2810725271701813, -0.042970042675733566));
	r += float4(-0.002999944379553199, -0.00032871754956431687, -0.0008756309398449957, 0.0008809737046249211);
	return r;
}
void Pass2(uint2 blockStart, uint3 tid) {
	float2 pt = float2(GetInputPt());
	uint2 gxy = Rmp8x8(tid.x) + blockStart;
	uint2 size = GetInputSize();
	if (gxy.x >= size.x || gxy.y >= size.y) {
		return;
	}
	float2 pos = (gxy + 0.5) * pt;
	min16float4 s0_0 = l0(-1.0, -1.0);
	min16float4 s0_1 = l0(0.0, -1.0);
	min16float4 s0_2 = l0(1.0, -1.0);
	min16float4 s0_3 = l0(-1.0, 0.0);
	min16float4 s0_4 = l0(0.0, 0.0);
	min16float4 s0_5 = l0(1.0, 0.0);
	min16float4 s0_6 = l0(-1.0, 1.0);
	min16float4 s0_7 = l0(0.0, 1.0);
	min16float4 s0_8 = l0(1.0, 1.0);
	min16float4 s1_0 = max(-s0_0, 0.0);
	min16float4 s1_1 = max(-s0_1, 0.0);
	min16float4 s1_2 = max(-s0_2, 0.0);
	min16float4 s1_3 = max(-s0_3, 0.0);
	min16float4 s1_4 = max(-s0_4, 0.0);
	min16float4 s1_5 = max(-s0_5, 0.0);
	min16float4 s1_6 = max(-s0_6, 0.0);
	min16float4 s1_7 = max(-s0_7, 0.0);
	min16float4 s1_8 = max(-s0_8, 0.0);
	s0_0 = max(s0_0, 0.0);
	s0_1 = max(s0_1, 0.0);
	s0_2 = max(s0_2, 0.0);
	s0_3 = max(s0_3, 0.0);
	s0_4 = max(s0_4, 0.0);
	s0_5 = max(s0_5, 0.0);
	s0_6 = max(s0_6, 0.0);
	s0_7 = max(s0_7, 0.0);
	s0_8 = max(s0_8, 0.0);
	min16float4 s2_0 = l1(-1.0, -1.0);
	min16float4 s2_1 = l1(0.0, -1.0);
	min16float4 s2_2 = l1(1.0, -1.0);
	min16float4 s2_3 = l1(-1.0, 0.0);
	min16float4 s2_4 = l1(0.0, 0.0);
	min16float4 s2_5 = l1(1.0, 0.0);
	min16float4 s2_6 = l1(-1.0, 1.0);
	min16float4 s2_7 = l1(0.0, 1.0);
	min16float4 s2_8 = l1(1.0, 1.0);
	min16float4 s3_0 = max(-s2_0, 0.0);
	min16float4 s3_1 = max(-s2_1, 0.0);
	min16float4 s3_2 = max(-s2_2, 0.0);
	min16float4 s3_3 = max(-s2_3, 0.0);
	min16float4 s3_4 = max(-s2_4, 0.0);
	min16float4 s3_5 = max(-s2_5, 0.0);
	min16float4 s3_6 = max(-s2_6, 0.0);
	min16float4 s3_7 = max(-s2_7, 0.0);
	min16float4 s3_8 = max(-s2_8, 0.0);
	s2_0 = max(s2_0, 0.0);
	s2_1 = max(s2_1, 0.0);
	s2_2 = max(s2_2, 0.0);
	s2_3 = max(s2_3, 0.0);
	s2_4 = max(s2_4, 0.0);
	s2_5 = max(s2_5, 0.0);
	s2_6 = max(s2_6, 0.0);
	s2_7 = max(s2_7, 0.0);
	s2_8 = max(s2_8, 0.0);
	conv1_0[gxy] = f0(pt, pos, s0_0, s0_1, s0_2, s0_3, s0_4, s0_5, s0_6, s0_7, s0_8, s1_0, s1_1, s1_2, s1_3, s1_4, s1_5, s1_6, s1_7, s1_8, s2_0, s2_1, s2_2, s2_3, s2_4, s2_5, s2_6, s2_7, s2_8, s3_0, s3_1, s3_2, s3_3, s3_4, s3_5, s3_6, s3_7, s3_8);
	conv1_1[gxy] = f1(pt, pos, s0_0, s0_1, s0_2, s0_3, s0_4, s0_5, s0_6, s0_7, s0_8, s1_0, s1_1, s1_2, s1_3, s1_4, s1_5, s1_6, s1_7, s1_8, s2_0, s2_1, s2_2, s2_3, s2_4, s2_5, s2_6, s2_7, s2_8, s3_0, s3_1, s3_2, s3_3, s3_4, s3_5, s3_6, s3_7, s3_8);
}
//!PASS 3
//!DESC CuNNy-1x8C-BILINEAR-NVL-down
//!BLOCK_SIZE 8
//!NUM_THREADS 64
//!IN conv1_0, conv1_1
//!OUT down
#define O(t, p) t.SampleLevel(SP, pos + p * pt, 0)
#define l0(x, y) O(conv1_0, float2(x, y))
#define l1(x, y) O(conv1_1, float2(x, y))
float4 f0(float2 pt, float2 pos, min16float4 s0_0, min16float4 s0_1, min16float4 s0_2, min16float4 s0_3, min16float4 s0_4, min16float4 s0_5, min16float4 s0_6, min16float4 s0_7, min16float4 s0_8, min16float4 s1_0, min16float4 s1_1, min16float4 s1_2, min16float4 s1_3, min16float4 s1_4, min16float4 s1_5, min16float4 s1_6, min16float4 s1_7, min16float4 s1_8, min16float4 s2_0, min16float4 s2_1, min16float4 s2_2, min16float4 s2_3, min16float4 s2_4, min16float4 s2_5, min16float4 s2_6, min16float4 s2_7, min16float4 s2_8, min16float4 s3_0, min16float4 s3_1, min16float4 s3_2, min16float4 s3_3, min16float4 s3_4, min16float4 s3_5, min16float4 s3_6, min16float4 s3_7, min16float4 s3_8) {
	min16float4 r = 0.0;
	r += mul(s0_0, min16float4x4(0.13192056119441986, -0.02886728197336197, -0.05626535788178444, 0.014156232587993145, -0.022522298619151115, 0.011627716943621635, -0.015727033838629723, 0.00014393645687960088, 0.06581904739141464, 0.031995922327041626, 0.017755556851625443, 0.018201399594545364, -0.06716997921466827, 0.02395622991025448, -0.005360839422792196, -0.00602302048355341));
	r += mul(s0_1, min16float4x4(-0.2878371477127075, 0.22134248912334442, 0.06969307363033295, -0.11093856394290924, -0.034641850739717484, -0.06859538704156876, 0.013463051058351994, -0.041615355759859085, 0.029774200171232224, 0.061096105724573135, 0.004857569467276335, 0.01612994447350502, 0.031018568202853203, -0.03659119829535484, -0.07942450046539307, -0.08954665809869766));
	r += mul(s0_2, min16float4x4(0.07192802429199219, -0.22974839806556702, 0.01480881404131651, 0.12927165627479553, -0.03638229891657829, -0.011989344842731953, -0.04115920886397362, 0.006510844454169273, 0.0006352473865263164, 0.016783103346824646, -0.010271015577018261, -0.017398156225681305, -0.0319814495742321, -0.008318084292113781, -0.030230063945055008, 0.005933391395956278));
	r += mul(s0_3, min16float4x4(0.05125323683023453, 0.09107779711484909, -0.19650408625602722, 0.06328695267438889, -0.03633055090904236, -0.0191059447824955, -0.10571510344743729, -0.01431290339678526, -0.0935070812702179, -0.04063928872346878, 0.1020277664065361, -0.015162036754190922, 0.00980408862233162, 0.15031121671199799, -0.08326169103384018, 0.1189626082777977));
	r += mul(s0_4, min16float4x4(1.6363716125488281, 0.8840330243110657, -1.3310468196868896, -1.3007822036743164, 0.6270382404327393, 0.3887041509151459, -0.05175891891121864, -0.26769888401031494, -0.019945483654737473, -0.015561307780444622, 0.04194694012403488, 0.2395467609167099, 0.02681446261703968, -0.17281174659729004, 0.24611590802669525, -0.06276722997426987));
	r += mul(s0_5, min16float4x4(-0.03765765205025673, 0.5600028038024902, -0.05061071366071701, -0.3603101968765259, -0.20428256690502167, -0.0336429663002491, -0.07300521433353424, 0.04659691080451012, -0.02891514264047146, -0.0614028200507164, -0.010824679397046566, -0.03011508099734783, -0.06429647654294968, -0.08569152653217316, -0.09855122119188309, -0.10937332361936569));
	r += mul(s0_6, min16float4x4(-0.026297496631741524, 0.024416083469986916, 0.046590451151132584, -0.08080461621284485, -0.12636178731918335, -0.1272306740283966, 0.366229772567749, 0.004130048677325249, 0.0038355295546352863, -0.07205601036548615, -0.0473918691277504, -0.0709216371178627, -0.0026603243313729763, 0.027775011956691742, -0.023616693913936615, 0.02082810364663601));
	r += mul(s0_7, min16float4x4(-0.07168777287006378, -0.1278422623872757, -0.02872888185083866, 0.1937457025051117, -0.7744784355163574, -0.4638657867908478, 0.09822459518909454, 1.0824954509735107, 0.013518483377993107, 0.014062680304050446, -0.029850870370864868, -0.08158833533525467, 0.04868532344698906, 0.025799639523029327, 0.01266409270465374, -0.02727779559791088));
	r += mul(s0_8, min16float4x4(0.003182430984452367, 0.02551610767841339, 0.04069070145487785, -0.027729365974664688, 0.09832004457712173, -0.054061584174633026, 0.21000513434410095, -0.2856852412223816, -0.00494539737701416, -0.026694389060139656, -0.007317688781768084, -0.047751810401678085, 0.006725116167217493, -0.02452167496085167, 0.02023089863359928, 0.0028243742417544127));
	r += mul(s1_0, min16float4x4(-0.002797786146402359, -0.015731027349829674, -0.023604650050401688, -0.013063310645520687, 0.05864321440458298, -0.008228986524045467, -0.001386299030855298, 0.012988769449293613, -0.7090730667114258, 0.4914488196372986, -0.05227618291974068, 0.19491685926914215, 0.07151032239198685, -0.0009221251821145415, 0.005335292778909206, -0.010801233351230621));
	r += mul(s1_1, min16float4x4(0.03820805624127388, 0.044311728328466415, 0.050720568746328354, 0.012220044620335102, -0.05338457599282265, 0.04589490219950676, 0.06571365147829056, 0.07436905801296234, -0.1372244656085968, 0.21782705187797546, -0.14337864518165588, -0.0070940665900707245, 0.13259556889533997, 0.08722054958343506, -0.03233710676431656, -0.008830728009343147));
	r += mul(s1_2, min16float4x4(-0.028470801189541817, -0.02715497650206089, -0.02508908323943615, 0.002104120561853051, 0.03359153866767883, 0.014544087462127209, 0.03467390686273575, -0.015928078442811966, 0.018142225220799446, -0.06519654393196106, 0.01155523769557476, 0.04873549938201904, -0.0352705642580986, 0.06373170018196106, 0.008855129592120647, 0.033111702650785446));
	r += mul(s1_3, min16float4x4(-0.008908535353839397, -0.01059967651963234, 0.011549052782356739, 0.00569612393155694, 0.013206691481173038, 0.037961896508932114, 0.0770515650510788, 0.0007915233727544546, -0.04480777680873871, 0.47950711846351624, -1.1184611320495605, 0.6546599864959717, -0.11133535206317902, -0.06428736448287964, 0.06827908009290695, -0.047976382076740265));
	r += mul(s1_4, min16float4x4(0.027568750083446503, 0.004068347625434399, 0.02667955309152603, 0.05268438160419464, -0.06970670074224472, -0.06567907333374023, -0.27441418170928955, -0.12861181795597076, 0.7653436064720154, -1.5899392366409302, 0.7246119976043701, -0.2626933753490448, 0.3662489950656891, -0.7207046747207642, 0.6245056390762329, -0.1964125782251358));
	r += mul(s1_5, min16float4x4(-0.016053399071097374, 0.006806321907788515, -0.034056976437568665, -0.0597902350127697, 0.029605815187096596, 0.03619980439543724, 0.05873150750994682, 0.08666829764842987, -0.04281202703714371, 0.17700277268886566, -0.012537233531475067, 0.002692247973755002, -0.05625496804714203, 0.17922388017177582, -0.037009332329034805, 0.27066072821617126));
	r += mul(s1_6, min16float4x4(-0.0032804792281240225, 0.00814665574580431, 0.002173992805182934, 0.00531188165768981, 0.002113677328452468, 0.011345162987709045, -0.008205839432775974, -0.007529084105044603, -0.035540830343961716, -0.10802503675222397, 0.45951536297798157, -0.07761245965957642, 0.015813913196325302, 0.003628915175795555, -0.05749987065792084, 0.0002945895539596677));
	r += mul(s1_7, min16float4x4(0.004993785172700882, -0.004106339067220688, 0.006765982136130333, -0.01212120521813631, -0.015645496547222137, -0.02522728219628334, -0.02196476049721241, -0.0019243216374889016, 0.10717513412237167, 0.32727667689323425, 0.17672155797481537, -0.40932613611221313, 0.017089229077100754, 0.037576910108327866, 0.07740964740514755, -0.18126992881298065));
	r += mul(s1_8, min16float4x4(-0.0016852860571816564, -0.006635976489633322, -0.00027180451434105635, 0.008123859763145447, -0.0017741163028404117, 0.02112230844795704, -0.006249006371945143, -0.010869458317756653, -0.08343034237623215, 0.13449609279632568, -0.0854327380657196, 0.10032270848751068, -0.008903912268579006, 0.0007701063295826316, -0.02062796801328659, 0.0340454988181591));
	r += mul(s2_0, min16float4x4(-0.43807607889175415, -0.013105236925184727, 0.2945239543914795, 0.2068309485912323, 0.01946973241865635, -0.01229842845350504, 0.010137305594980717, -0.012194695882499218, -0.3326759934425354, 0.22191466391086578, -0.11683672666549683, 0.269770085811615, -0.011197739280760288, -0.003262835554778576, -0.010037191212177277, 0.023554550483822823));
	r += mul(s2_1, min16float4x4(0.2151360958814621, -0.19415834546089172, -0.0710792988538742, 0.18017053604125977, 0.017859578132629395, -0.017523016780614853, 0.045593876391649246, 0.0020816773176193237, 0.01173712033778429, 0.26872044801712036, 0.044092919677495956, -0.2150265872478485, -0.07787035405635834, 0.0028760461136698723, -0.04382333904504776, 0.04061349481344223));
	r += mul(s2_2, min16float4x4(-0.046934615820646286, 0.0455658957362175, -0.0402231402695179, -0.01721525751054287, 0.0032392707653343678, -0.012757373042404652, -0.017745761200785637, 0.03493059426546097, 0.0007796554709784687, -0.030199380591511726, -0.020451636984944344, 0.029730750247836113, 0.0010580846574157476, 0.00047041315701790154, 0.051147665828466415, -0.05463472753763199));
	r += mul(s2_3, min16float4x4(0.21117956936359406, -0.0768231451511383, -0.3564453721046448, 0.07838360965251923, 0.04334045574069023, -0.034397561103105545, 0.008462858386337757, -0.03258572891354561, 1.3280199766159058, -1.3398510217666626, 0.47188833355903625, -0.8321634531021118, -0.09401007741689682, -0.06614375859498978, -0.016718748956918716, -0.04945361241698265));
	r += mul(s2_4, min16float4x4(0.15327788889408112, 0.7089850902557373, -0.16324886679649353, -0.4492996633052826, -0.08586949110031128, -0.07117687165737152, -0.1391625553369522, -0.07144127041101456, -0.2057788074016571, 0.10206996649503708, -0.18007418513298035, 0.7781535983085632, -0.16163226962089539, -0.022396983578801155, -0.09692442417144775, 0.024608174338936806));
	r += mul(s2_5, min16float4x4(-0.0034703051205724478, -0.1491200029850006, 0.0709962323307991, -0.08227493613958359, -0.02218662202358246, 0.0042569441720843315, 0.04916730150580406, -0.0866699293255806, 0.014127695932984352, -0.05564593896269798, 0.04436216875910759, -0.11058355122804642, 0.13525554537773132, 0.05675668641924858, 0.07357724756002426, 0.19091887772083282));
	r += mul(s2_6, min16float4x4(0.010798386298120022, -0.050281278789043427, 0.026868950575590134, -0.007728729397058487, 0.003774444106966257, 0.03329307585954666, 0.010725797154009342, 0.021839594468474388, 0.07694286853075027, -0.07117582857608795, 0.5668476223945618, -0.5705317258834839, -0.002837698208168149, -0.0074237254448235035, -0.03785375878214836, -0.03186964988708496));
	r += mul(s2_7, min16float4x4(-0.05868082493543625, 0.02967257611453533, 0.034708939492702484, 0.03917105495929718, 0.06052560731768608, 0.11244408786296844, 0.09517610818147659, 0.055931221693754196, -0.013015764765441418, 0.10049349814653397, 0.003574059111997485, -0.1169445812702179, -0.021448642015457153, -0.006338917650282383, -0.05531948804855347, -0.05253515765070915));
	r += mul(s2_8, min16float4x4(0.009669087827205658, -0.06372079253196716, 0.01209200732409954, 0.028954172506928444, 0.03398539125919342, -0.0015609451802447438, 0.024965206161141396, 0.11108242720365524, 0.004367909859865904, -0.011684296652674675, -0.007229670416563749, 0.015282678417861462, 0.01817467249929905, 0.03569621592760086, -0.008581303060054779, -0.04547348618507385));
	r += mul(s3_0, min16float4x4(-0.08148827403783798, 0.01114202756434679, 0.02257644757628441, -0.0010312112281098962, -0.00260758469812572, -0.019654475152492523, -0.0009904179023578763, -0.0020453508477658033, -0.004463037475943565, -0.011448121629655361, 0.011330168694257736, -0.04051682725548744, -0.0271737240254879, 0.02840239927172661, 0.033909767866134644, -0.002838547807186842));
	r += mul(s3_1, min16float4x4(0.026035256683826447, -0.12744146585464478, -0.02217310480773449, 0.011894306167960167, -0.08680936694145203, -0.08182767778635025, 0.04319804534316063, 0.0734863132238388, -0.05706628039479256, -0.03863641247153282, -0.03144967555999756, -0.009325751103460789, 0.03453400731086731, 0.12654224038124084, -0.06340403854846954, -0.06070002168416977));
	r += mul(s3_2, min16float4x4(0.0026021813973784447, 0.03409378603100777, 0.022395974025130272, 0.023482931777834892, 0.02874693274497986, -0.0032915312331169844, 0.030475322157144547, -0.04551733285188675, 0.016296975314617157, -0.015923893079161644, 0.012493318878114223, -0.009602644480764866, 0.03626653552055359, -0.05822852998971939, -0.004896627739071846, 0.041291140019893646));
	r += mul(s3_3, min16float4x4(0.13169234991073608, 0.09974989295005798, -0.10863696783781052, 0.09256432205438614, -0.006844967603683472, 0.06670695543289185, -0.058928266167640686, -0.004083896521478891, 0.09885190427303314, 0.08088617771863937, 0.009766688570380211, 0.06861834973096848, 0.10674358159303665, -0.015545682050287724, 0.04149658605456352, 0.03155355900526047));
	r += mul(s3_4, min16float4x4(0.0699811726808548, 0.06117616221308708, 0.03242257982492447, -0.3831343352794647, 0.8998686075210571, 0.4677748680114746, -0.3230714499950409, -0.48570623993873596, -0.09912687540054321, -0.028835689648985863, -0.09790340065956116, -0.11127281934022903, -0.6191402673721313, 0.46991389989852905, -0.2607496380805969, 0.7519558072090149));
	r += mul(s3_5, min16float4x4(0.020984837785363197, 0.09146641194820404, -0.020096430554986, 0.119870625436306, -0.06186678260564804, 0.14856241643428802, -0.09581983089447021, 0.06684140861034393, 0.04731974005699158, 0.04277065023779869, 0.018698183819651604, 0.03373732790350914, -0.009484093636274338, -0.186344176530838, 0.04265652596950531, -0.31158342957496643));
	r += mul(s3_6, min16float4x4(-0.026738598942756653, 0.03551911935210228, -0.01980252005159855, 0.030941743403673172, -0.01746363379061222, 0.09742286801338196, -0.3435470461845398, 0.08433373272418976, -0.019419001415371895, -0.006790473125874996, 0.018979713320732117, 0.025104785338044167, 0.0074789077043533325, -0.005170134827494621, 0.08449104428291321, -0.00479725981131196));
	r += mul(s3_7, min16float4x4(-0.0494408942759037, -0.07157309353351593, 0.01026450376957655, 0.05480634421110153, -0.2866138219833374, -0.8491204977035522, 1.2006019353866577, -0.43309423327445984, -0.0030245550442487, -0.008621109649538994, 0.005428757984191179, 0.03258457034826279, -0.01929105445742607, 0.01811407320201397, -0.09008830785751343, 0.197855606675148));
	r += mul(s3_8, min16float4x4(-0.006186756305396557, 0.025678755715489388, -0.008894071914255619, 0.01469465158879757, -0.1384139508008957, 0.005178419407457113, -0.23311181366443634, 0.2740083634853363, 0.00648350128903985, -0.007096029818058014, 0.012414705008268356, -0.002934318734332919, -0.009711571037769318, -0.02398979291319847, 0.02185770310461521, 0.0044470783323049545));
	r += float4(7.31741965864785e-05, -0.0003762503038160503, 0.0005689350073225796, 0.00015152909327298403);
	return tanh(r);
}
void Pass3(uint2 blockStart, uint3 tid) {
	float2 pt = float2(GetInputPt());
	uint2 gxy = Rmp8x8(tid.x) + blockStart;
	uint2 size = GetInputSize();
	if (gxy.x >= size.x || gxy.y >= size.y) {
		return;
	}
	float2 pos = (gxy + 0.5) * pt;
	min16float4 s0_0 = l0(-1.0, -1.0);
	min16float4 s0_1 = l0(0.0, -1.0);
	min16float4 s0_2 = l0(1.0, -1.0);
	min16float4 s0_3 = l0(-1.0, 0.0);
	min16float4 s0_4 = l0(0.0, 0.0);
	min16float4 s0_5 = l0(1.0, 0.0);
	min16float4 s0_6 = l0(-1.0, 1.0);
	min16float4 s0_7 = l0(0.0, 1.0);
	min16float4 s0_8 = l0(1.0, 1.0);
	min16float4 s1_0 = max(-s0_0, 0.0);
	min16float4 s1_1 = max(-s0_1, 0.0);
	min16float4 s1_2 = max(-s0_2, 0.0);
	min16float4 s1_3 = max(-s0_3, 0.0);
	min16float4 s1_4 = max(-s0_4, 0.0);
	min16float4 s1_5 = max(-s0_5, 0.0);
	min16float4 s1_6 = max(-s0_6, 0.0);
	min16float4 s1_7 = max(-s0_7, 0.0);
	min16float4 s1_8 = max(-s0_8, 0.0);
	s0_0 = max(s0_0, 0.0);
	s0_1 = max(s0_1, 0.0);
	s0_2 = max(s0_2, 0.0);
	s0_3 = max(s0_3, 0.0);
	s0_4 = max(s0_4, 0.0);
	s0_5 = max(s0_5, 0.0);
	s0_6 = max(s0_6, 0.0);
	s0_7 = max(s0_7, 0.0);
	s0_8 = max(s0_8, 0.0);
	min16float4 s2_0 = l1(-1.0, -1.0);
	min16float4 s2_1 = l1(0.0, -1.0);
	min16float4 s2_2 = l1(1.0, -1.0);
	min16float4 s2_3 = l1(-1.0, 0.0);
	min16float4 s2_4 = l1(0.0, 0.0);
	min16float4 s2_5 = l1(1.0, 0.0);
	min16float4 s2_6 = l1(-1.0, 1.0);
	min16float4 s2_7 = l1(0.0, 1.0);
	min16float4 s2_8 = l1(1.0, 1.0);
	min16float4 s3_0 = max(-s2_0, 0.0);
	min16float4 s3_1 = max(-s2_1, 0.0);
	min16float4 s3_2 = max(-s2_2, 0.0);
	min16float4 s3_3 = max(-s2_3, 0.0);
	min16float4 s3_4 = max(-s2_4, 0.0);
	min16float4 s3_5 = max(-s2_5, 0.0);
	min16float4 s3_6 = max(-s2_6, 0.0);
	min16float4 s3_7 = max(-s2_7, 0.0);
	min16float4 s3_8 = max(-s2_8, 0.0);
	s2_0 = max(s2_0, 0.0);
	s2_1 = max(s2_1, 0.0);
	s2_2 = max(s2_2, 0.0);
	s2_3 = max(s2_3, 0.0);
	s2_4 = max(s2_4, 0.0);
	s2_5 = max(s2_5, 0.0);
	s2_6 = max(s2_6, 0.0);
	s2_7 = max(s2_7, 0.0);
	s2_8 = max(s2_8, 0.0);
	down[gxy] = f0(pt, pos, s0_0, s0_1, s0_2, s0_3, s0_4, s0_5, s0_6, s0_7, s0_8, s1_0, s1_1, s1_2, s1_3, s1_4, s1_5, s1_6, s1_7, s1_8, s2_0, s2_1, s2_2, s2_3, s2_4, s2_5, s2_6, s2_7, s2_8, s3_0, s3_1, s3_2, s3_3, s3_4, s3_5, s3_6, s3_7, s3_8);
}
//!PASS 4
//!DESC CuNNy-1x8C-BILINEAR-NVL-shuffle
//!STYLE PS
//!IN down, INPUT
float4 Pass4(float2 pos) {
	float2 pt = float2(GetInputPt());
	const static float3x3 rgb2yuv = {0.299, 0.587, 0.114, -0.169, -0.331, 0.5, 0.5, -0.419, -0.081};
	const static float3x3 yuv2rgb = {1, -0.00093, 1.401687, 1, -0.3437, -0.71417, 1, 1.77216, 0.00099};
	float4 r = 0.0;
	float2 size = float2(GetInputSize());
	float2 f = frac(pos * size);
	float3 yuv = mul(rgb2yuv, INPUT.SampleLevel(SL, pos, 0).rgb);
	int2 i = int2(f * 2.0);
	r.r = down.SampleLevel(SP, (float2(0.5, 0.5) - f) * pt + pos, 0)[2*i.y + i.x];
	r.r += yuv.r;
	r.a = 1.0;
	r.r = clamp(r, 0.0, 1.0);
	float3 px = mul(yuv2rgb, float3(r.r, yuv.yz));
	return float4(px, 1.0);
}
